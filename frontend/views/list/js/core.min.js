var sdk=window["AWY_SDK"]||{};var gc={};sdk.gameId=0;sdk.token=sdk.getItem("token");sdk.code=sdk.getURLVar("code");gc.chid=sdk.getURLVar("chid");gc.subchid=sdk.getURLVar("subchid");gc.isShowPointGift=sdk.getURLVar("showPointGift");gc.isTrial=0;gc.width=$(window).width();gc.height=$(window).height();gc.subheight=0;gc.time=new Date;gc.startTime=new Date("2018/1/10 10:00:00");gc.endTime=new Date("2018/1/12 23:59:59");gc.actUrl="https://act.wxavu.com/a20171229/";gc.actList=[{title:"【妖怪宝可萌】今日注册送京东卡！",startTime:new Date("2018/1/10 10:00:00"),endTime:new Date("2018/1/16 23:59:59"),desc:"活动时间：2018/01/10 ~ 2018/01/16",img:"./image/ad_2.gif",url:"https://act.wxavu.com/a20171229/"},{title:"【雷霆战神】开年巨献",startTime:new Date("2018/1/4 11:00:00"),endTime:new Date("2018/1/10 23:59:59"),desc:"活动时间：2018/01/04 ~ 2018/01/10",img:"./image/ad_1.gif",url:"https://act.wxavu.com/a20171228/"}];gc.apiBaseURL="https://web.11h5.com/api?";gc.enterURL="https://shopapi.11h5.com:13059/game?";gc.pointGiftURL="https://shopapi.11h5.com/game?";gc.pointGiftImgURL="https://img.11h5.com/score";gc.toolInfoURL="https://api.11h5.com/";gc.gameBlankList=[];gc.pointGiftAutoGameList=[206,97,170,157,295];gc.filterGoodsId=[60,66];gc.recentList=null;gc.adList=null;gc.isStat=false;gc.shareInfo={};gc.useShare={};var infoScroll=0;var infoview=false;gc.myPoints=0;gc.myVip=0;var dayLimit=0;var dayCount=0;gc.pageSize=12;gc.page={hot:1,oldService:1,newService:1,active:1,notice:1,gift:1,pointGet:1,pointLost:1};gc.status={ad:true,hot:true,new:true,oldService:true,newService:true,active:true,notice:true,gift:true,userRule:true,pointGift:true,pointReal:true,pointLog:true,pointExchangeLog:true,pointGetLog:true,getUserInfo:true,sign:false,bindPhone:true,verify:true};gc.isReady=true;gc.isFocusAvy=false;gc.isFocusAvyPlus=false;gc.isGetBindPhonePrize=true;gc.isGetBindIdcardPrize=true;gc.phoneNumber=null;gc.idcard=null;gc.shopNavIndex=2;gc.giftNavIndex=1;gc.gameNavIndex=0;gc.userNavIndex=4;Date.prototype.format=function(format){var o={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds()};if(/(y+)/.test(format))format=format.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length));for(var k in o)if(new RegExp("("+k+")").test(format))format=format.replace(RegExp.$1,RegExp.$1.length==1?o[k]:("00"+o[k]).substr((""+o[k]).length));return format};gc.httpGet=function(url,callback){$.get(url+"&v="+Date.now(),function(data){if(data.error){if(parseInt(data.error)<15){gc.pointGiftError(data.error)}}else{callback(data)}},"json")};gc.slider=function(data){var t="";for(var i in data){t+='<li onclick="sdk.combineStat('+sdk.uid+",'首页Banner', [{'广告位':'"+(parseInt(i)+1)+"号位'}])\"><a onclick=\"gc.rebuildGameURL('"+data[i].link_url+'\')" href="javascript:;"><img src="'+data[i].ad_pic_url+'" ></a></li>'}$(".slide-banner ol").append(t);if(data.length>1){TouchSlide({slideCell:"#slide",titCell:".hd ul",mainCell:".bd ol",effect:"leftLoop",interTime:4e3,autoPage:true,autoPlay:true})}};gc.postActMessage=function(data){if(window["ad_iframe"].postMessage){window["ad_iframe"].postMessage(data,"*")}else if(window["ad_iframe"].contentWindow.postMessage){window["ad_iframe"].contentWindow.postMessage(data,"*")}};gc.loadGameAct=function(){if(gc.time>gc.startTime){if(gc.time<gc.endTime){var t='<div class="flex red-packet">';t+='<div class="flex"><i class="icon-red-packet"></i><span>有奖活动</span></div>';t+='<div class="flex-list">';t+="<ol>";t+='<li><a class="flex-list" id="open_act_1" href="javascript:;">【妖怪宝可萌】今日注册送京东卡！</a></li>';t+="</ol>";t+="</div>";t+="</div>";$("#slide").after(t);if(gc.chid){gc.actUrl=sdk.buildURL(gc.actUrl,{chid:gc.chid})}if(gc.subchid){gc.actUrl=sdk.buildURL(gc.actUrl,{subchid:gc.subchid})}$(".wrap-box").append('<div class="ad_back"><img id="open_act" src="./image/rotate.png" class="ad_rotate"></div>');function _loadGameAct(){if(sdk.token){sdk.createCode(sdk.token,function(data){if(data.code){if(!$(".ad_box").length){$("body").append('<div class="ad_box"><i class="icon-cancel"></i><iframe id="ad_iframe" name="ad_iframe" src="'+sdk.buildURL(gc.actUrl,{cp_key:1,code:data.code})+'"></iframe></div>');$(".ad_box>i").off().click(function(){gc.useShare.title=gc.shareInfo.title;gc.useShare.desc=gc.shareInfo.desc;gc.useShare.link=gc.shareInfo.link;$(".ad_box").remove()})}}})}else{parent.location=gc.actUrl}}$("#open_act").click(function(){sdk.combineStat(sdk.uid,"运营活动",[{"活动名称":"妖怪宝可萌20180110"},{"广告位":"游戏中心小转盘"}]);_loadGameAct()});$("#open_act_1").click(function(){sdk.combineStat(sdk.uid,"运营活动",[{"活动名称":"妖怪宝可萌20180110"},{"广告位":"有奖活动公告"}]);_loadGameAct()});window.addEventListener("message",function(event){if(event&&event.data){switch(event.data.cmd){case"share":sdk.showShare();gc.useShare.title="去吧皮卡丘";gc.useShare.desc="今日注册送京东卡！";gc.useShare.link=gc.actUrl;break}}},false)}}if(gc.actList.length>0){var count=0;var t='<ol id="prize-box" class="active-box">';for(var i in gc.actList){if(gc.time>gc.actList[i].startTime){count++;t+='<li class="rec">';t+='\t<a href="'+gc.actList[i].url+'" class="active">';t+='\t\t<img src="'+gc.actList[i].img+'">';t+='\t\t<div class="flex">';t+='\t\t\t<p class="flex-list flex flex-v">';t+="\t\t\t\t<span>"+gc.actList[i].title+"</span>";t+="\t\t\t\t<span>"+gc.actList[i].desc+"</span>";t+="\t\t\t</p>";if(gc.time<gc.actList[i].endTime){t+='\t\t\t<div class="btn r3"><i class="icon-time"></i>进行中</div>'}else{t+='\t\t\t<div class="btn r3 end"><i class="icon-time"></i>已结束</div>'}t+="\t\t</div>";t+="\t</a>";t+="</li>"}}t+="</ol>";if(count){$("#join_prize").after('<li class="flex-list"><a href="#prize">有奖</a></li>');$("#active-box").after(t)}}};gc.getPageBase=function(){if(gc.status.ad){gc.httpGet(gc.apiBaseURL+"getPageBase",function(data){gc.status.ad=false;gc.adList=data.ad;gc.recentList=data.recent_play;var count=0;var _count=0;gc.slider(gc.adList);if(gc.recentList.length){$(".recommend").show();var t="";for(var i in gc.recentList){if(i<10){count++;t+="<li><a onclick=\"gc.rebuildGameURL('"+gc.recentList[i].game_url+'\')" href="javascript:;"><img class="r5" src="'+gc.recentList[i].icon+'" ><span>'+gc.recentList[i].title+"</span></a><a onclick=\"gc.rebuildGameURL('"+gc.recentList[i].game_url+'\')" href="javascript:;" class="btn r3">开始</a></li>'}if(i<5){if(gc.gameBlankList.indexOf(gc.recentList[i].id)>=0){_count++}}}$(".recommend dd ol").css("width",count*5.15+2+"rem").append(t);setTimeout(function(){var scroll=new IScroll("#wrapper-rec",{scrollX:true,mouseWheel:true,click:true});scroll.on("scrollStart",function(){$(".recommend dt").animate({opacity:".1"},500)});scroll.on("scrollEnd",function(){if(Math.abs(this.x)<=5){$(".recommend dt").css({opacity:"1"})}})},100)}if(!_count){gc.loadGameAct()}})}};gc.fillInfo=function(data){var t="";t+='<li class="notice">';if(data.f){if(location.hash.indexOf("game/")>-1){data.gameid=location.hash.split("/")[1]}t+='<a class="flex" onclick="gc.getInfoContent('+data.id+",'"+data.title+"',"+data.inputtime*1e3+",'"+location.hash+"',"+data.gameid+')" href="javascript:;">'}else{t+='<a class="flex" href="'+data.link_url+'">'}if(data.labels.indexOf(1)>=0){t+='<span><i class="tags-new">新游</i></span>'}if(data.labels.indexOf(2)>=0){t+='<span><i class="tags-recommend">活动</i></span>'}if(data.labels.indexOf(3)>=0){t+='<span><i class="tags-hot">新服</i></span>'}if(data.labels.indexOf(4)>=0){t+='<span><i class="tags-elite">攻略</i></span>'}if(data.labels.indexOf(5)>=0){t+='<span><i class="tags-coupon">公告</i></span>'}t+='<span class="flex-list">'+data.title+"</span>";t+="<span>"+new Date(data.inputtime*1e3).format("yyyy-MM-dd")+"</span>";t+="</a>";t+="</li>";return t};gc.fillGift=function(data,id,url,callback){var t="";if(callback){t+='<li class="gift">';t+='<div class="flex">';t+='<img class="r5" src="'+data.icon+'">';t+='<div class="flex-list title"><strong>'+data.gameTitle+"</strong></div>";t+="</div>";t+="<ul>"}var gifts=data.gifts;for(var i in gifts){t+='<li class="flex">';t+='<div class="flex-list">';t+='<p class="title">';if(parseInt(gifts[i].isDayGift)){t+='<span class="tags-coupon">每日</span>'}else if(parseInt(gifts[i].qq_group_num)){t+='<em class="tags-qq">入群</em>'}else if(gifts[i].union_code){t+='<span class="tags-coupon">统一码</span>'}else if(gifts[i].sum){t+='<em class="tags-normal">普通</em>'}t+=gifts[i].title;t+="</p>";if(gifts[i].brief_intro.length>50){t+='<p class="intro">'+gifts[i].brief_intro.replace(/\r\n/g,"<br>").substring(0,50)+"...<span onclick=\"sdk.confirmDialog('"+gifts[i].brief_intro.replace(/\r\n/g,"<br>")+"',null,null,null,null,'礼包详细')\">详细</span></p>"}else{t+='<p class="intro">'+gifts[i].brief_intro+"</p>"}t+="</div>";var start=new Date(gifts[i].effect_time*1e3);if(start>new Date){var diff=(start.getTime()-(new Date).getTime())/1e3;var dd=Math.floor(diff/(24*3600));var lv1=diff%(24*3600);var hh=Math.floor(lv1/3600);var lv2=lv1%3600;var mm=Math.floor(lv2/60);t+='<a href="javascript:;" class="btn r3 disabled alone">未开放<em>';if(dd){t+=dd+"天"}if(hh){t+=hh+"小时"}if(mm){t+=mm+"分"}t+="后开放领取";t+="</em></a>"}else{if(parseInt(gifts[i].isDayGift)){t+='<a href="javascript:;" onclick="getCode('+id+","+gifts[i].type+","+gifts[i].isDayGift+',this)" class="btn r3">领取</a>'}else if(parseInt(gifts[i].qq_group_num)){t+="<a onclick=\"gc.joinGroup('"+gifts[i].qq_group_link+'\')" href="javascript:;" class="btn r3">加群</a>'}else if(parseInt(gifts[i].sum)==parseInt(gifts[i].getcount)&&!gifts[i].union_code){t+='<a href="javascript:;" class="btn r3 disabled">缺货</a>'}else{t+='<a href="javascript:;" onclick="getCode('+id+","+gifts[i].type+',null,this)" class="btn r3">';if(gifts[i].getCode){t+="查看"}else{t+="领取"}t+="</a>"}}t+="</li>"}if(callback){t+="</ul>";if(data.giftCnt>1){t+='<p data-url="'+data.game_url+'" onclick="gc.loadGameInfo('+data.gameID+',this)">查看更多礼包('+(data.giftCnt-1)+') <i class="icon-bottom"></i></p>'}t+="</li>"}return t};gc.addLabels=function(data,isnew){var t="";if(isnew){if(data.indexOf(6)>=0){t+='<span class="tags-first">首发</span>'}else if(data.indexOf(5)>=0){t+='<span class="tags-new">独家</span>'}}else{if(data.indexOf(5)>=0){t+='<span class="tags-new">独家</span>'}}if(data.indexOf(4)>=0){t+='<span class="tags-coupon">礼包</span>'}return t};gc.loadGameHot=function(){if(gc.page.hot){gc.httpGet(gc.apiBaseURL+"getRecoGames&page="+gc.page.hot+"&pageSize="+gc.pageSize,function(data){var t="";data=data.data;gc.status.hot=false;if(data&&data.length){for(var i in data){t+='<li class="flex"><div class="new">';if(Date.parse(gc.time)/1e3-data[i].recoEndTime<7*24*3600){t+="<i>新游</i>"}t+='<img class="r5" onclick="gc.loadGameInfo('+data[i].id+",this,['热门','icon区域'])\" src=\""+data[i].icon+'"></div>';t+='<div onclick="gc.loadGameInfo('+data[i].id+',this,[\'热门\',\'标题区域\'])" class="flex flex-list flex-v"><p class="title"><span>'+data[i].title+"</span>";t+=gc.addLabels(data[i].labels);t+="</p>";if(data[i].brief_intro){t+="<p>"+data[i].brief_intro+"</p>"}t+="</div><a onclick=\"gc.rebuildGameURL('"+data[i].game_url+"',this,['热门','开始按钮'])\" href=\"javascript:;\" class=\"btn r3\">开始</a></li>"}$("#hot-box").append(t);$("#hot-box li.end").remove();if(data.length>=gc.pageSize){gc.page.hot++;gc.isReady=true;$("#hot-box").append('<li class="end"><fieldset><legend>松开手自动加载</legend></fieldset></li>')}else{gc.page.hot=false;$("#hot-box").append('<li class="end"><fieldset><legend>没有更多了</legend></fieldset></li>')}}else{gc.page.hot=false;$("#hot-box li.end legend").text("没有更多了")}})}};gc.loadGameNew=function(){gc.httpGet(gc.apiBaseURL+"getNewGames&page=1&pageSize=15",function(data){var t="";data=data.data;gc.status.new=false;if(data&&data.length){for(var i in data){t+='<li class="flex"><img class="r5" onclick="gc.loadGameInfo('+data[i].id+",this,['新上架','icon区域'])\" src=\""+data[i].icon+'">';t+='<div onclick="gc.loadGameInfo('+data[i].id+',this,[\'新上架\',\'标题区域\'])" class="flex flex-list flex-v"><p class="title"><span>'+data[i].title+"</span>";t+=gc.addLabels(data[i].labels,true);t+="</p>";if(data[i].brief_intro){t+="<p>"+data[i].brief_intro+"</p>"}t+="</div><a onclick=\"gc.rebuildGameURL('"+data[i].game_url+"',this,['新上架','开始按钮'])\" href=\"javascript:;\" class=\"btn r3\">开始</a></li>"}}t+='<li class="end"><fieldset><legend>没有更多了</legend></fieldset></li>';$("#new-box").append(t)})};gc.loadActiveList=function(e){gc.httpGet(gc.apiBaseURL+"getNews&type=2&page=1&pageSize=20",function(data){var t="";var ot="";var _now=(new Date).format("yyyyMMdd");data=data.data;gc.status.active=false;function _fillActive(data,online){var _t="";_t+='<li class="rec">';if(data.f){if(data.subtitle){_t+='<a href="javascript:;" onclick="gc.getInfoContent('+data.id+",'"+data.subtitle+"',"+data.inputtime*1e3+",'"+location.hash+"',"+data.gameid+')" class="active">'}else{_t+='<a href="javascript:;" onclick="gc.getInfoContent('+data.id+",'"+data.title+"',"+data.inputtime*1e3+",'"+location.hash+"',"+data.gameid+')" class="active">'}}else{_t+='<a href="'+data.link_url+'" class="active">'}_t+='<img src="'+data.image+'">';_t+='<div class="flex"><p class="flex-list flex flex-v">';_t+="<span>"+data.title+"</span>";_t+="<span>活动时间："+new Date(data.startTime*1e3).format("yyyy/MM/dd")+" ~ "+new Date(data.endTime*1e3).format("yyyy/MM/dd")+"</span></p>";if(!online){_t+='<div class="btn r3 end"><i class="icon-time"></i>已结束</div></div>'}else{_t+='<div class="btn r3"><i class="icon-time"></i>进行中</div></div>'}_t+="</a>";_t+="</li>";return _t}if(data&&data.length){for(var i in data){var _end=new Date(data[i].endTime*1e3).format("yyyyMMdd");if(_now<=_end){t+=_fillActive(data[i],true)}else if(Date.parse(new Date)/1e3-data[i].endTime<2*24*60*60){ot+=_fillActive(data[i],false)}}t+=ot;if(e){$(e).parents(".end").remove()}$("#active-box").append(t);$("#active-box li").click(function(e){var index=$(e.target).parents("li.rec").index()+1;sdk.combineStat(sdk.uid,"游戏列表",[{"广告位":"活动"},{"行号":"第"+index+"行"}])})}})};gc.loadNoticeList=function(){if(gc.page.notice){gc.httpGet(gc.apiBaseURL+"getNews&type=5&page="+gc.page.notice+"&pageSize="+gc.pageSize,function(data){var t="";data=data.data;gc.status.notice=false;if(data&&data.length){for(var i in data){t+=gc.fillInfo(data[i])}$("#notice-box").append(t);$("#notice-box li.end").remove();if(data.length>=gc.pageSize){gc.page.notice++;gc.isReady=true;$("#notice-box").append('<li class="end"><fieldset><legend>松开手自动加载</legend></fieldset></li>')}else{gc.page.notice=false;$("#notice-box").append('<li class="end"><fieldset><legend>没有更多了</legend></fieldset></li>')}}else{gc.page.notice=false;$("#notice-box li.end legend").text("没有更多了")}})}};gc.inforeback=function(hash){location.hash=hash;setTimeout(function(){$("body").scrollTop(infoScroll)},10)};gc.getInfoContent=function(id,title,time,hash,gameid){infoScroll=$("body").scrollTop();var t='<div class="flex-list">';t+='<h1 class="title">'+title+"</h1>";t+='<span class="time">'+new Date(time).format("yyyy-MM-dd hh:mm:ss")+"</span>";t+='<div class="txt"></div>';t+="</div>";t+='<div class="flex">';t+='<a href="javascript:;" onclick="gc.inforeback(\''+hash+'\')" class="flex-list btn">返回列表</a>';if(gameid){t+=' <a href="javascript:;" onclick="gc.rebuildGameURL(\'//play.11h5.com/game/?gameid='+gameid+'\')" class="flex-list btn">进入游戏</a>'}t+="</div>";$(".infoView").empty().append(t);$(".infoView .txt").load("//img.11h5.com/news/json/post_"+id+".html",function(){infoview=true;$(".infoView").removeClass("hide").siblings().addClass("hide");$(".infoView .txt table").css({width:"auto",height:"auto"});$(".infoView .txt table td").css({border:".05rem solid #ededf0",padding:".2rem"}).removeAttr("nowrap");location.hash="infoview"})};gc.svrRemind=function(e,name){sdk.combineStat(sdk.uid,"游戏列表",[{"广告位":"新服预告"},{"点击位置":"开服提醒按钮"},{"预约游戏":name}]);if(sdk.token){if(gc.isFocusAvyPlus){sdk.confirmDialog("您确定要预约新服吗","是的","关闭",function(){var gameid=$(e).attr("data-id");var zname=$(e).attr("data-zname");gc.httpGet(gc.apiBaseURL+"addZoneRemind&gameid="+gameid+"&zname="+zname,function(data){if(data.error==0){sdk.confirmDialog("恭喜您，预约成功！<br>微信爱微游Plus公众号将在开服时给您推送消息，还请留意！")}else if(data.error==30002){sdk.confirmDialog("您已经预约过了")}else{sdk.confirmDialog("预约失败！")}})},null)}else{sdk.focus()}}else{sdk.confirmDialog("开服提醒需要登录后才能操作","现在就去","知道了",function(){sdk.auth()},null)}};gc.loadNewServer=function(){if(gc.page.newService){gc.httpGet(gc.apiBaseURL+"getZones&page="+gc.page.newService+"&pageSize="+gc.pageSize+"&type=1",function(data){var t="";data=data.r;gc.status.newService=false;if(data&&data.length){for(var i in data){var open_time=new Date(data[i].open_time*1e3);t+='<li class="flex">';t+='<img onclick="gc.loadGameInfo('+data[i].gameID+",this,['新服预告','icon区域','"+data[i].gname+'\'])" src="'+data[i].icon+'">';t+='<div onclick="gc.loadGameInfo('+data[i].gameID+",this,['新服预告','标题区域','"+data[i].gname+'\'])" class="flex flex-list flex-v">';t+='<p class="title">';if(data[i].gname.length>5){t+=data[i].gname.substr(0,5)+"..."}else{t+=data[i].gname}t+="</p>";t+="<p>"+data[i].zname+"</p>";t+="</div>";t+="<span>";if((new Date).getDate()==open_time.getDate()){t+="今日"}else{t+="明日"}t+=open_time.format("hh:mm")+"开服</span>";if(open_time-new Date<9e5){t+='<a href="javascript:;" class="btn r3 end">即将开服'}else{t+='<a data-id="'+data[i].gameID+'" data-zname="'+data[i].zname+'" onclick="gc.svrRemind(this,\''+data[i].gname+'\')" href="javascript:;" class="btn r3 active">开服提醒'}t+="</a>";t+="</li>"}$("#server-box").append(t);$("#server-box li.end").remove();if(data.length>=gc.pageSize){gc.page.newService++;gc.isReady=true;$("#server-box").append('<li class="end"><fieldset><legend>松开手自动加载</legend></fieldset></li>')}else{gc.page.newService=false;$("#server-box").append('<li class="end"><fieldset><legend>没有更多了</legend></fieldset></li>')}}else{gc.page.newService=false;$("#server-box li.end legend").text("没有更多了")}})}};gc.loadReadyServer=function(){if(gc.page.oldService){gc.httpGet(gc.apiBaseURL+"getZones&page="+gc.page.oldService+"&pageSize="+gc.pageSize+"&type=3",function(data){var t="";data=data.r;gc.status.oldService=false;if(data&&data.length){for(var i in data){var open_time=new Date(data[i].open_time*1e3);var oldTime=(new Date).getHours()-open_time.getHours()+"小时";if((new Date).getDate()!=open_time.getDate()){oldTime=(new Date).getHours()+24-open_time.getHours()+"小时"}if(oldTime.replace("小时","")>24){oldTime="1天"+(oldTime.replace("小时","")-24)+"小时"}if(oldTime=="0小时"){oldTime=(new Date).getMinutes()-open_time.getMinutes()+"分钟"}t+='<li class="flex">';t+='<img onclick="gc.loadGameInfo('+data[i].gameID+",this,['已开新服','icon区域','"+data[i].gname+'\'])" src="'+data[i].icon+'">';t+='<div onclick="gc.loadGameInfo('+data[i].gameID+",this,['已开新服','标题区域','"+data[i].gname+'\'])" class="flex flex-list flex-v">';t+='<p class="title">';if(data[i].gname.length>5){t+=data[i].gname.substr(0,5)+"..."}else{t+=data[i].gname}t+="</p>";t+="<p>"+data[i].zname+"</p>";t+="</div>";t+="<span>已开服"+oldTime+"</span>";t+="<a onclick=\"gc.rebuildGameURL('"+data[i].game_url+"',this,['已开新服','开始游戏按钮','"+data[i].gname+'\'])" href="javascript:;" class="btn r3">开始游戏</a>';t+="</li>"}$("#today-box").append(t);$("#today-box li.end").remove();if(data.length>=gc.pageSize){gc.page.oldService++;gc.isReady=true;$("#today-box").append('<li class="end"><fieldset><legend>松开手自动加载</legend></fieldset></li>')}else{gc.page.oldService=false;$("#today-box").append('<li class="end"><fieldset><legend>没有更多了</legend></fieldset></li>')}}else{gc.page.oldService=false;$("#today-box li.end legend").text("没有更多了")}})}};gc.loadGiftList=function(){if(gc.page.gift){gc.httpGet(gc.apiBaseURL+"getJhGroupByGame&page="+gc.page.gift+"&pageSize="+gc.pageSize,function(data){var t="";data=data.r;gc.status.gift=false;if(data&&data.length){for(var i in data){data[i].name=data[i].gameTitle;t+=gc.fillGift(data[i],data[i].gameID,data[i].game_url,true)}$("#gift-box").append(t);$("#gift-box li.end").remove();if(data.length>=gc.pageSize){gc.page.gift++;gc.isReady=true;$("#gift-box").append('<li class="end"><fieldset><legend>松开手自动加载</legend></fieldset></li>')}else{gc.page.gift=false;$("#gift-box").append('<li class="end"><fieldset><legend>没有更多了</legend></fieldset></li>')}}else{gc.page.gift=false;$("#gift-box li.end legend").text("没有更多了")}},"json")}};gc.tabLabel=function(e){$(e).addClass("active").siblings().removeClass("active");$(e).parents(".game-info").find(".show-box>*").eq($(e).index()).removeClass("hide").siblings().addClass("hide")};gc.hideMore=function(e){$(e).html("全文");$(e).attr("onclick","gc.showMore(this)");$(e).prev().empty().append("...")};gc.showMore=function(e){$(e).html("收起");$(e).attr("onclick","gc.hideMore(this)");$(e).prev().empty().append($(e).attr("data-des"))};gc.loadGameInfo=function(id,e,args){gc.httpGet(gc.apiBaseURL+"getGameInfo&id="+id,function(data){var _data=data.data;var gift=data.gift;var count=0;var giftList="";var newsList="";var t="";var _gift={gifts:{}};for(var i=0;i<gift.length;i++){var gifts=null;gifts=gift[i];_gift["gifts"][i]={};_gift["gifts"][i]=gifts}if(e&&!args){t+=gc.fillGift(_gift,id,_data.game_url);$(e).prev().empty().append(t);$(e).remove()}else{location.hash="game/"+id;$(window).scrollTop(0);t='<div class="game-info">';t+='<a href="javascript:;" onclick="gc.rebuildGameURL(\''+_data.game_url+'\')"><img src="'+_data.bg_image+'" ></a>';t+='<div class="flex flex-v">';t+='<img class="r10" src="'+_data.icon+'">';t+="<p>"+_data.title+"</p>";t+="<p>"+_data.brief_intro+"</p>";t+='<a href="javascript:;" onclick="gc.rebuildGameURL(\''+_data.game_url+'\')" class="btn">开始游戏</a>';t+="</div>";t+='<dl class="summary">';t+="<dt>游戏简介</dt>";t+="<dd>";_data.description=_data.description.replace(/\r\n/gi,"|").replace(/\[more]/gi," ");if(_data.description.length>100){var _des=_data.description.substring(0,90),_subDes=_data.description.substring(90,_data.description.length);if(_des.substr(-1)=="|"){_des=_data.description.substring(0,89);_subDes=_data.description.substring(89,_data.description.length)}if(_subDes.substr(-1)=="|"){_subDes=_subDes.substring(0,_subDes.length-1)}t+="<p>"+_des.replace(/\|/gi,"<br>")+'<span>...</span><span class="more" data-des="'+_subDes.replace(/\|/gi,"<br>")+'" onclick="gc.showMore(this)">全文</span></p>'}else{t+="<p>"+_data.description.replace(/\|/gi,"<br>")+"</p>"}t+="</dd>";t+="</dl>";if(gift.length>0){count++;giftList+='<li class="gift"><ul>';giftList+=gc.fillGift(_gift,id,_data.game_url);giftList+="</ul></li>"}if(_data.news.length>0){count++;for(var i in _data.news){newsList+=gc.fillInfo(_data.news[i])}}if(count>1){t+='<ol class="flex nav">';t+='<li onclick="gc.tabLabel(this)" class="flex-list active"><a href="javascript:;">礼包</a></li>';t+='<li onclick="gc.tabLabel(this)" class="flex-list"><a href="javascript:;">资讯</a></li>';t+="</ol>";t+='<div class="show-box">';t+='<ol class="">';t+=giftList;t+="</ol>";t+='<ol class="exc hide">';t+=newsList;t+="</ol>";t+='<div class="flex flex-v infoView hide"></div>';t+="</div>"}else{if(giftList){t+='<dl class="summary">';t+="<dt>游戏礼包</dt>";t+='<dd class="show-box">';t+='<ol class="active alone">';t+=giftList;t+="</ol>";t+="</dd>";t+="</dl>"}if(newsList){t+='<dl class="summary">';t+="<dt>游戏资讯</dt>";t+='<dd class="show-box">';t+='<ol class="active">';t+=newsList;t+="</ol>";t+='<div class="flex flex-v infoView hide"></div>';t+="</dd>";t+="</dl>"}}if(_data.developer||_data.recordNum||_data.publisher){t+='<dl class="summary">';t+="<dt>游戏信息</dt>";t+="<dd>";if(_data.developer){t+="<p>研发商："+_data.developer+"</p>"}if(_data.publisher){t+="<p>发行商："+_data.publisher+"</p>"}if(_data.recordNum){t+="<p>文网游备字："+_data.recordNum+"</p>"}t+="</dd>";t+="</dl>"}t+="</div>";$("#box-4").empty().append(t)}},"json");if(args){var index=$(e).parents("li.flex").index()+1;if(args[2]){sdk.combineStat(sdk.uid,"游戏列表",[{"广告位":args[0]},{"游戏名称":args[2]},{"点击位置":args[1]}])}else{sdk.combineStat(sdk.uid,"游戏列表",[{"广告位":args[0]},{"行号":"第"+index+"行"},{"点击位置":args[1]}])}}};gc.rebuildGameURL=function(url,e,args){if(args){var index=$(e).parents("li.flex").index()+1;if(args[2]){sdk.combineStat(sdk.uid,"游戏列表",[{"广告位":args[0]},{"游戏名称":args[2]},{"点击位置":args[1]}])}else{sdk.combineStat(sdk.uid,"游戏列表",[{"广告位":args[0]},{"行号":"第"+index+"行"},{"点击位置":args[1]}])}}function _buildURL(){if(gc.chid){url=sdk.buildURL(url,{chid:gc.chid});if(gc.isTrial){url=sdk.buildURL(url,{trial:1})}}if(gc.subchid){url=sdk.buildURL(url,{subchid:gc.subchid})}if(sdk.isWeixin()){url=sdk.buildURL(url,{backGC:1})}if(sdk.isAvuAPP()){if(sdk.isiOS()){sdk.initWebViewJavascriptBridge(function(){if(window.WebViewJavascriptBridge){window.WebViewJavascriptBridge.callHandler("setRefresh",true);window.WebViewJavascriptBridge.callHandler("setBack",false);window.WebViewJavascriptBridge.callHandler("setGoTo",true);window.WebViewJavascriptBridge.callHandler("setShare",{wxsession:true,wxtimeline:false,qq:false,qzone:false});window.WebViewJavascriptBridge.callHandler("setGoToURL",location.href)}})}else if(sdk.isAndroid()){window.android.setRefresh(true);window.android.setBack(false);window.android.setGoTo(true);window.android.setShare('{"wxsession": true, "wxtimeline": false, "qq": true, "qzone": true}');window.android.setGoToURL(location.href)}}location.href=url}if(sdk.token){sdk.createCode(sdk.token,function(data){if(data.code){url=sdk.buildURL(url,{code:data.code})}_buildURL()})}else{_buildURL()}};function clearCache(){if(sdk.isiOS()){sdk.initWebViewJavascriptBridge(function(){if(window.WebViewJavascriptBridge){window.WebViewJavascriptBridge.callHandler("clearCache")}})}else if(sdk.isAndroid()){window.android.clearCache()}sdk.confirmDialog("清理完成",null,"好的",null,null)}gc.joinGroup=function(href){window.open(href)};function getCode(id,type,isDayGift,e){if(sdk.token){if(!isDayGift){gc.httpGet(gc.apiBaseURL+"drawJh&gameid="+id+"&type="+type,function(data){$(e).html("查看");var t='<div class="flex gift-dialog"><label>兑换码：</label><div class="r3">'+$.trim(data.activation_code)+'</div></div><p class="gift-dialog-info">复制兑换码，去游戏中使用</p>';sdk.confirmDialog(t,null,"复制",null,function(){setTimeout(function(){sdk.copy($.trim(data.activation_code))},50)},"领取提示")})}else{gc.httpGet(gc.apiBaseURL+"getGameRoleList&gameid="+id+"&type="+type,function(data){data=data.roleList;if(data.length){var _userName="";var _userId="";var _serverId="";var t='<div class="serviceArea"><div class="flex">';t+="<label>区服：</label>";t+='<select id="serviceChange" class="flex-list">';t+='<option value="0" data-user="">请选择区服</option>';for(var i in data){t+='<option data-userid="'+data[i].roleid+'" data-user="'+data[i].rolename+'" value="'+data[i].serverid+'">'+data[i].servername+"</option>"}t+="</select>";t+="</div>";t+='<div class="flex">';t+="<label>角色：</label>";t+='<input type="text" class="flex-list" id="userNameChange"  disabled readonly>';t+="</div>";t+="</div>";sdk.confirmDialog(t,"确认",null,function(){if(!parseInt(_serverId)){sdk.confirmDialog("缺少必填参数")}else{$.get(gc.apiBaseURL+"sendGameDayGift&gameid="+id+"&type="+type+"&serverid="+_serverId+"&roleid="+_userId,function(data){switch(parseInt(data.error)){case 0:sdk.setItem("dayGift_serverid_"+id,_serverId);sdk.confirmDialog("礼包已发放，请进入游戏领取","进入游戏",null,function(){gc.rebuildGameURL("http://play.11h5.com/game/?gameid="+id)},null,"领取提示");break;case 4:sdk.confirmDialog("今日已领取");break;case 5:sdk.confirmDialog("角色不存在");break;case 1:case 2:case 3:case 6:sdk.confirmDialog("系统错误");break}},"json")}},null,"请先选择区服角色",function(){$("#serviceChange").change(function(){var _this=$(this);var _index=_this.prop("selectedIndex");var _obj=_this.find("option").eq(_index);_userName=_obj.attr("data-user");_userId=_obj.attr("data-userid");_serverId=_this.val();$("#userNameChange").val(decodeURIComponent(_userName))});if(sdk.getItem("dayGift_serverid_"+id)){$("#serviceChange").val(sdk.getItem("dayGift_serverid_"+id));$("#serviceChange").trigger("change")}})}else{sdk.confirmDialog("您还没有创建过角色哦","立即创建",null,function(){gc.rebuildGameURL("http://play.11h5.com/game/?gameid="+id)},null,"提示")}})}}else{sdk.confirmDialog("礼包需要登录后才能领取","现在就去","知道了",function(){sdk.auth()},null)}}gc.setAppTitle=function(title,url){if(sdk.isAvuAPP()){if(sdk.isiOS()){sdk.initWebViewJavascriptBridge(function(){if(window.WebViewJavascriptBridge){window.WebViewJavascriptBridge.callHandler("setTitle",title);window.WebViewJavascriptBridge.callHandler("setRefresh",true);window.WebViewJavascriptBridge.callHandler("setBack",true);window.WebViewJavascriptBridge.callHandler("setGoTo",false);window.WebViewJavascriptBridge.callHandler("setShare",{wxsession:false,wxtimeline:false,qq:false,qzone:false})}})}else if(sdk.isAndroid()){window.android.setTitle(title);window.android.setRefresh(true);window.android.setBack(true);window.android.setGoTo(false);window.android.setShare('{"wxsession": false, "wxtimeline": false, "qq": false, "qzone": false}')}$(".download").remove();$(".cache").show()}if(url){location.href=url}};gc.userRule=function(){$("body").append('<div id="help-content" style="display:none;"></div>');sdk.showLoading();$("#help-content").load("./agreement.html?v=002 .wrap",function(){$("#box-8").empty().append($("#gc-guide").html());$("#box-9").empty().append($("#gc-agreement").html());$("#box-10").empty().append($("#gc-dispute").html());sdk.hideLoading();gc.status.userRule=false})};gc.myIdVerify=function(){$("#myIdSubmit").off().click(function(){var myName=$.trim($("#myName").val());var myId=$.trim($("#myId").val());if(myName==""){sdk.confirmDialog("请填写您的真实姓名",null,"好的",null,function(){$("#myName").focus()});return}if(myId==""){sdk.confirmDialog("请填写您的真实身份证号码",null,"好的",null,function(){$("#myId").focus()});return}gc.httpGet(gc.toolInfoURL+"addRealVerify"+"&realname="+myName+"&idcard="+myId,function(data){if(data.error){switch(data.error){case 60004:sdk.confirmDialog("该身份证号码已经实名注册过",null,"好的",null,null);break;case 60005:sdk.confirmDialog("该身份证号码有误",null,"好的",null,null);break}}else{$("#bindIdStatus").attr("href","javascript:;").attr("onclick","gc.getBindIdPrize()").html("领取");sdk.confirmDialog("恭喜您认证成功",null,"好的",null,function(){location.hash="user"})}})})};gc.getBindIdPrize=function(){gc.httpGet(gc.enterURL+"getBindIdcardPrize",function(data){if(data.score){$("#bindIdStatus").removeAttr("onclick").addClass("disabled").html("已完成");$(".mypoint").html(data.score)}})};gc.getBindPhonePrize=function(){gc.httpGet(gc.enterURL+"getBindPhonePrize",function(data){if(data.score){$("#bindPhoneStatus").removeAttr("onclick").addClass("disabled").html("已完成");$(".mypoint").html(data.score)}})};gc.isRealVerify=function(callback){if(sdk.token){if(gc.idcard){callback(gc.idcard);return}gc.httpGet(gc.toolInfoURL+"isRealVerify",function(data){if(data.isVerify){gc.idcard=data.idcard;if(callback){callback(data.idcard)}}else{if(callback){callback()}}})}};gc.isBindPhone=function(callback){if(gc.phoneNumber){callback(gc.phoneNumber);return}if(!sdk.isQQ()){if(sdk.uid){$.get("https://login.11h5.com/account/api.php?c=phone&d=getPhoneByUid&uid="+sdk.uid+"&v"+Date.now(),function(data){if(data.phone){gc.phoneNumber=data.phone;if(callback){callback(data.phone)}}else{if(callback){callback()}}},"json")}}};gc.bindMobile=function(){function _fill(data,callback){var t='<div><img class="r50" src="//cdn.11h5.com/static/image/vutimes.png"></div>';if(data){t+='<p class="info">您的手机号：'+data+"</p>"}if(!data){t+='<div class="flex"><i class="icon-phone"></i><input class="flex-list" type="number" id="gcPhone" placeholder="请输入您的手机号码"></div>';t+='<div class="flex"><i class="icon-pwd"></i><input class="flex-list" type="password" id="gcPwd" placeholder="请输入您的密码"></div>';t+='<div class="flex"><i class="icon-img"></i><input class="flex-list" type="number" id="gcImgCode" placeholder="请输入图片验证码"><img id="gcRefreshCode" src=""></div>';t+='<div class="flex"><i class="icon-sms"></i><input class="flex-list" type="number" id="gcSmsCode" placeholder="请输入短信验证码"><a href="javascript:;" id="gcGetCode">获取验证码</a></div>'}if(data){t+="<p>您已绑定手机，可使用手机登录，保障账号安全</p>";t+='<a href="javascript:;" data-type="1" id="unBindMobile" class="btn subtn">解除绑定</a>'}else{t+="<p>绑定后，可使用手机登录，保障账号安全</p>";t+='<a href="javascript:;" id="bindMobile" class="btn subtn">完成绑定</a>'}$("#box-6").empty().append(t);if(callback){callback()}}gc.isBindPhone(function(data){if(data){
_fill(data,function(){$("#unBindMobile").off().click(function(){var _this=$(this);var type=parseInt(_this.attr("data-type"));if(type==1){_this.attr("data-type",2);var t='<div class="flex"><i class="icon-phone"></i><input class="flex-list" type="number" readonly disabled value="'+data+'" placeholder="请输入您的手机号码"></div>';t+='<div class="flex"><i class="icon-img"></i><input class="flex-list" type="number" id="gcImgCode" placeholder="请输入图片验证码"><img id="gcRefreshCode" src=""></div>';t+='<div class="flex"><i class="icon-sms"></i><input class="flex-list" type="number" id="gcSmsCode" placeholder="请输入短信验证码"><a href="javascript:;" id="gcGetCode">获取验证码</a></div>';$("#box-6 .info").after(t);sdk.getVerifyImg("#gcRefreshCode");$("#gcGetCode").off().click(function(){if($(this).attr("class")!="active"){var _imgCode=$.trim($("#gcImgCode").val());sdk.mobileParamsCheck({phone:data,imgCode:_imgCode},function(){sdk.getSmsCode({phone:data,imgCode:_imgCode,type:1},function(){sdk.smsCountDown(true,"#gcGetCode")})})}})}else{var _imgCode=$.trim($("#gcImgCode").val());var _smsCode=$.trim($("#gcSmsCode").val());sdk.mobileParamsCheck({phone:data,imgCode:_imgCode,smsCode:_smsCode},function(){sdk.mobileObjectBase({d:"unbindPhone",phone:data,smsCode:_smsCode},function(){location.reload()})})}})})}else{_fill(null,function(){sdk.getVerifyImg("#gcRefreshCode");$("#bindMobile").off().click(function(){var _phone=$.trim($("#gcPhone").val());var _pwd=$.trim($("#gcPwd").val());var _imgCode=$.trim($("#gcImgCode").val());var _smsCode=$.trim($("#gcSmsCode").val());sdk.mobileParamsCheck({phone:_phone,pwd:_pwd,imgCode:_imgCode,smsCode:_smsCode},function(){sdk.mobileObjectBase({d:"bindUidForPhone",phone:_phone,smsCode:_smsCode,passwd:_pwd,token:sdk.token,uid:sdk.uid},function(){$("#bindPhoneStatus").attr("href","javascript:;").attr("onclick","gc.getBindPhonePrize()").html("领取");sdk.confirmDialog("绑定成功",null,"好的",null,function(){location.hash="#user"})})})});$("#gcGetCode").off().click(function(){if($(this).attr("class")!="active"){var _phone=$.trim($("#gcPhone").val());var _pwd=$.trim($("#gcPwd").val());var _imgCode=$.trim($("#gcImgCode").val());sdk.mobileParamsCheck({phone:_phone,pwd:_pwd,imgCode:_imgCode},function(){sdk.getSmsCode({phone:_phone,imgCode:_imgCode,type:3},function(){sdk.smsCountDown(true,"#gcGetCode")})})}})})}})};gc.pointGiftError=function(error){switch(parseInt(error)){case 1:sdk.confirmDialog("出了一点小状况");break;case 2:sdk.confirmDialog("缺少必要参数");break;case 3:sdk.confirmDialog("请重新登录");break;case 4:sdk.confirmDialog("非法参数");break;case 5:sdk.confirmDialog("礼包不存在");break;case 6:sdk.confirmDialog("兑换次数超过每日上限");break;case 7:sdk.confirmDialog("兑换次数超过上限");break;case 8:sdk.confirmDialog("积分不足");break;case 9:sdk.confirmDialog("礼包不足");break;case 10:sdk.confirmDialog("游戏礼包暂未开放");break;case 11:sdk.confirmDialog("角色不存在");break;case 12:sdk.confirmDialog("您的VIP等级不足");break;case 14:sdk.confirmDialog("手机号码有误");break;case 60001:break;default:sdk.confirmDialog("未知错误，请联系客服")}};gc.pointList=function(error){switch(parseInt(error)){case 0:return 10;case 1:return 15;case 2:return 60;case 3:return 25;case 4:return 30;case 5:return 35;case 6:return 200;default:return 10}};gc.hideSignUp=function(){$("#signBox").remove()};gc.signUp=function(){function _sign(data,txt){var t='<div onclick="gc.hideSignUp()" id="signBox" class="mask sign">';t+='<div class="r3">';t+='\r<i class="icon-cancel"></i>';t+='\r<div class="sign-head">'+(txt?txt:"签到成功")+"</div>";t+='\r<div class="sign-progress">';t+='\r\r<ol class="flex">';t+='\r\r\r<li class="r50 first flex"><em>+10</em><span>第1天</span></li>';t+='\r\r\r<li class="r50 first flex"><em>+15</em><span>第2天</span></li>';t+='\r\r\r<li class="r50 first flex multiple"><img src="./image/king.png"><em><i class="number">3</i>倍<br>积分</em><span>第3天</span></li>';t+='\r\r\r<li class="r50 last flex"><em>+25</em><span>第4天</span></li>';t+='\r\r\r<li class="r50 last flex"><em>+30</em><span>第5天</span></li>';t+='\r\r\r<li class="r50 last flex"><em>+35</em><span>第6天</span></li>';t+='\r\r\r<li class="r50 last flex multiple"><img src="./image/king.png"><em><i class="number">5</i>倍<br>积分</em><span>第7天</span></li>';t+="\r\r</ol>";t+="\r</div>";t+='\r<p class="sign-info">连续签到获取更多积分</p>';t+="</div>";t+="</div>";$("body").append(t);sdk.setItem("sign",data);$("#signPointBtn").removeAttr("onclick").addClass("disabled").html("已完成");$(".signtype").addClass("disabled").html("已签到");$("#signPoint").html(gc.pointList(data));$("#sign i.icon-right").html("已签到").addClass("number").removeClass("icon-right");if(data){for(var i=0;i<data;i++){if(i==2||i==6){$(".sign-progress ol li").eq(i).find("em").html("+"+gc.pointList(i))}if(i==data-1){setTimeout(function(){$(".sign-progress ol li").eq(i).addClass("active animate").append('<i class="border r50"></i><i class="icon-signed"></i>')},600);return}else{$(".sign-progress ol li").eq(i).addClass("active").append('<i class="border r50"></i><i class="icon-signed"></i>')}}}}if(!sdk.token){sdk.confirmDialog("签到需要登录后才能继续","现在就去",null,function(){sdk.auth()},null)}else{if(!gc.status.sign){gc.httpGet(gc.enterURL+"signup",function(data){_sign(data.consecutiveSignup);gc.status.sign=true;$(".mypoint").html(data.diamond);$(".icon-market em,.signtype i").remove()})}else{_sign(parseInt(sdk.getItem("sign")),"今日已签到")}}};gc.hideFirstPay=function(){$("#firstPay").remove()};gc.firstPay=function(){var t='<div id="firstPay" class="mask firstPay">';t+='<div class="r3">';t+='\r<div>每日充值<i onclick="gc.hideFirstPay()" class="icon-cancel"></i></div>';t+="\r<div>";t+="\r\r<p>每日首次充值任意一款游戏</p>";t+='\r\r<div class="flex flex-x-center"><img src="./image/point.jpg"><p><strong>+50</strong>积分</p></div>';t+="\r</div>";t+="\r<dl>";t+="\r\r<dt>最近在玩</dt>";t+="\r\r<dd>";t+='\r\r\r<ol class="flex flex-x-between">';for(var i in gc.recentList){if(i<4){t+='<li class="flex-list"><a class="flex flex-v" onclick="gc.rebuildGameURL(\''+gc.recentList[i].game_url+'\')" href="javascript:;"><img class="r5" src="'+gc.recentList[i].icon+'" ><span>'+gc.recentList[i].title+"</span></a></li>"}}t+="</ol>";t+="\r\r</dd>";t+="\r</dl>";t+='\r<a href="javascript:;" onclick="gc.hideFirstPay()" class="btn">我知道了</a>';t+="</div>";t+="</div>";$("body").append(t)};gc.getUserInfo=function(){if(gc.status.getUserInfo){gc.status.getUserInfo=false;if(sdk.token){gc.httpGet(gc.apiBaseURL+"getUserInfo",function(data){if(data.uid){sdk.uid=data.uid;if(data.nickname){try{data.nickname=decodeURIComponent(data.nickname)}catch(e){data.nickname="微游玩家"}}else{data.nickname="微游玩家"}if(!data.headimgurl){data.headimgurl="//cdn.11h5.com/static/image/vutimes.png"}if((data.focus&1<<0)>0){gc.isFocusAvy=true}if((data.focus&1<<1)>0){gc.isFocusAvyPlus=true}var t='<div class="r50 active"><img class="headimg r50" src=""><em onclick="sdk.logout()"></em></div>';t+='<div class="flex flex-list flex-v flex-x-center">';t+='<p class="nickname"></p>';t+='<p>UID：<span id="uid"></span></p>';t+="</div>";$(".head").append(t);$(".user-info>div:nth-child(1)>em").addClass("active").empty();$(".headimg").attr("src",sdk.loadHeadImg(data.headimgurl,96));$(".nickname").text(data.nickname);$(".mypoint").text(data.lv);$("#uid").text(data.uid);if(data.vip){$(".user-info>div.r50").append('<div><i class="icon-king"></i><em>'+data.vip+"</em></div>")}gc.myPoints=data.lv;gc.myVip=data.vip}})}else{$(".head").append('<div class="r50"><img class="headimg r50" src=""><em onclick="sdk.logout()">获取头像</em></div>');$(".nickname").html("微游玩家");$(".headimg").attr("src","//cdn.11h5.com/static/image/vutimes.png")}}};gc.getPointGiftImg=function(url){return gc.pointGiftImgURL+url};gc.getPointGiftList=function(){gc.httpGet(gc.pointGiftURL+"getGameGoods&gameid=0",function(data){gc.status.pointGift=false;data=data.goodsList;var t="";for(var i in data){if(!parseInt(data[i].hide)||gc.isShowPointGift){t+='<li data-key="'+data[i].letter+'">';t+='\t<a href="#pointView" onclick="gc.getPointGiftDetail('+data[i].goods_id+')" class="flex flex-v">';t+='\t\t<div class="goods-show">';t+='\t\t\t<img class="r5" src="'+gc.getPointGiftImg(data[i].goods_thumb)+'">';t+="\t\t</div>";t+='\t\t<div class="flex flex-v goods-info">';t+="\t\t\t<strong>"+data[i].goods_name+"</strong>";t+='\t\t\t<div class="flex flex-x-between">';t+='\t\t\t\t<span><i class="icon-point"></i>'+data[i].point+"</span>";t+="\t\t\t\t<span>剩余：<em>"+data[i].goods_number+"</em></span>";t+="\t\t\t</div>";t+="\t\t</div>";t+="\t</a>";t+="</li>"}}$("#goods-item").empty().append(t)});gc.getPointChangeInfo()};gc.getPointRealList=function(){gc.httpGet(gc.pointGiftURL+"getRealGoods",function(data){if(!window.GL){var $GL=$("<script />",{src:"./js/location.min.js"});$("body").append($GL)}gc.status.pointReal=false;data=data.goodsList;var t="";for(var i in data){if(!parseInt(data[i].hide)||gc.isShowPointGift){t+='<li data-key="'+data[i].point+'">';t+='\t<a href="#pointRealView" onclick="gc.getPointGiftDetail('+data[i].goods_id+',true)" class="flex flex-v">';t+='\t\t<div class="goods-show r5 goods-show-sub">';if(data[i].vip_level){t+='<div class="flex flex-v v'+data[i].vip_level+'"><em><i class="icon-vip"></i>'+data[i].vip_level+"</em><span>可兑换</span></div>"}t+='\t\t\t<img class="r5" src="'+gc.getPointGiftImg(data[i].goods_thumb)+'">';t+="\t\t</div>";t+='\t\t<div class="flex flex-v goods-info">';t+="\t\t\t<strong>"+data[i].goods_name+"</strong>";t+='\t\t\t<div class="flex flex-x-between">';t+='\t\t\t\t<span><i class="icon-point"></i> '+data[i].point+"</span>";if(data[i].real_type){t+="<span>剩余：<em>"+data[i].goods_number+"</em></span>"}t+="\t\t\t</div>";t+="\t\t</div>";t+="\t</a>";t+="</li>"}}$("#real-item").empty().append(t)});gc.getPointChangeInfo()};gc.slide=function(ul,interval){setInterval(function(){var firstLI=$(ul).find("li").first();var height=firstLI.height()/20;$(ul).animate({top:"-"+height+"rem"},500,function(){$(ul).css("top",0);firstLI.detach()});firstLI.clone().appendTo(firstLI.parent())},interval)};gc.getPointChangeInfo=function(){if(gc.status.pointLog){gc.status.pointLog=false;gc.httpGet(gc.pointGiftURL+"getBuyLog",function(data){var data=data.log;var t="";for(var i in data){try{data[i].nickname=decodeURIComponent(data[i].nickname)}catch(e){data[i].nickname="微游玩家"}t+="<li><span>["+data[i].nickname+"]</span>兑换了 "+data[i].goods_name+"</li>"}$(".marquee ol").empty().append(t);gc.slide(".marquee ol",3e3)})}};gc.styleAmount=function(number,e){$("#amountNumber").html("剩余"+number);$(".goods-view-head img").attr("src",$(e).attr("data-color"))};gc.getPointGiftDetail=function(id,r){var t="";if(!r){gc.httpGet(gc.pointGiftURL+"getGoodsDesc&goodsId="+id,function(data){var recommend=data.recommendList;t+='<div class="flex goods-view-head">';t+='\t<div><img class="r3" src="'+gc.getPointGiftImg(data.goods.goods_thumb)+'"></div>';t+='\t<div class="flex flex-list flex-v flex-x-between">';t+='\t\t<p class="flex"><strong>'+data.goods.goods_name+"</strong></p>";t+="\t\t<p>所需积分：<span>"+data.goods.point+"</span></p>";t+='\t\t<p>剩余个数：<span id="goods-number">'+data.goods_number+"</span></p>";if(parseInt(gc.myPoints)<parseInt(data.goods.point)){t+='<a href="javascript:;" class="btn disabled">积分不足</a>'}else if(data.goods.buy_limit&&data.goods.buy_limit<=data.goods.buy_count){t+='<a href="javascript:;" class="btn disabled">兑换已达上限</a>'}else if(parseInt(data.goods.day_limit)!=0&&parseInt(data.goods.day_limit)<=parseInt(data.goods.daily_count)){t+='<a href="javascript:;" class="btn disabled">今日已达上限</a>'}else if(gc.myVip<data.goods.vip_level){t+='<a href="javascript:;" class="btn disabled">VIP等级不足</a>'}else{t+='<a href="javascript:;" id="change_btn" onclick="gc.goodsExchange('+id+","+data.goods.game_id+')" class="btn">兑换</a>'}t+="\t</div>";t+="</div>";t+='<dl class="goods-view-item">';t+="\t<dt><span>礼包内容</span></dt>";t+="\t<dd>"+data.goods.goods_brief+"</dd>";t+="</dl>";t+='<dl class="goods-view-item">';t+="\t<dt><span>领取方式</span></dt>";t+="\t<dd>"+data.getway+"</dd>";t+="</dl>";t+='<dl class="goods-view-item goods-view-recommend">';t+="\t<dt><span>猜你喜欢</span></dt>";t+="\t<dd>";t+='\t\t<ol class="flex flex-x-between">';for(var i in recommend){t+='<li><a href="#pointView" onclick="gc.getPointGiftDetail('+recommend[i].goods_id+')" class="flex flex-v"><img class="r3" src="'+gc.getPointGiftImg(recommend[i].goods_thumb)+'"><span>'+recommend[i].goods_name+"</span></a></li>"}t+="\t\t</ol>";t+="\t</dd>";t+="</dl>";$("#box-11 .box-5").empty().append(t);dayLimit=parseInt(data.goods.day_limit);dayCount=parseInt(data.goods.daily_count)})}else{gc.httpGet(gc.pointGiftURL+"getGoodsDesc&goodsId="+id,function(data){var userinfo=data.user_info;var isHave=false;t+="<div>";t+='\t<div class="flex goods-view-head">';t+='\t\t<div><img src="'+gc.getPointGiftImg(data.goods.goods_thumb)+'"></div>';t+='\t\t<div class="flex flex-list flex-v flex-x-between">';t+='\t\t\t<p class="flex"><strong class="flex-list">'+data.goods.goods_name+"</strong></p>";t+="\t\t\t<p>所需积分：<span>"+data.goods.point+"</span></p>";if(parseInt(data.goods.real_type)){t+='<p>剩余个数：<span id="goods-number">'+data.goods_number+"</span></p>"}t+="\t\t</div>";t+="\t</div>";t+='\t<ol class="goods-pra-rules">';if(data.styleAmountList!=""){t+='\t\t<li class="flex">';t+='\t\t\t<label class="active">选择</label>';t+='\t\t\t<ol class="flex flex-wrap" id="styleAmount">';for(var i in data.styleAmountList){var style=data.styleAmountList[i].styleList;if(parseInt(data.styleAmountList[i].amount)&&!parseInt(data.goods.real_type)){isHave=true;t+='<li class="check"><input name="color" id="style'+i+'" type="radio" value="'+data.styleAmountList[i].id+'" ><label data-color="'+(style[0].val=="黑"?"//game.11h5.com/image/black.jpg":"//game.11h5.com/image/white.jpg")+'" onclick="gc.styleAmount('+data.styleAmountList[i].amount+',this)" for="style'+i+'">'+style[0].val+"/"+style[1].val+"</label></li>"}else if(parseInt(data.goods.real_type)){if(data.goods_number){t+='<li class="check"><input name="color" id="style'+i+'" type="radio" value="'+data.styleAmountList[i].id+'" ><label for="style'+i+'">'+style[0].val+"</label></li>"}else{t+='<li class="check"><input name="color" id="style'+i+'" type="radio" ><label class="disabled">'+style[0].val+"</label></li>"}}else{t+='<li class="check"><input name="color" id="style'+i+'" type="radio" ><label class="disabled">'+style[0].val+"/"+style[1].val+"</label></li>"}}t+="\t\t\t</ol>";t+="\t\t</li>"}t+='\t\t<li class="flex">';t+="\t\t\t<label>数量</label>";t+='\t\t\t<input type="text" class="pra-number r3" readonly disabled value="1" >';t+='\t\t\t<span class="flex-list" id="amountNumber"></span>';t+="\t\t</li>";if(gc.filterGoodsId.indexOf(data.goodsId)==-1){t+='\t\t<li class="flex">'}else{t+='\t\t<li class="flex hide">'}t+="\t\t\t<label>姓名</label>";t+='\t\t\t<input class="flex-list r3" id="realname" type="text" value="'+(userinfo?userinfo.realname:"")+'" >';t+="\t\t</li>";t+='\t\t<li class="flex">';t+="\t\t\t<label>手机</label>";t+='\t\t\t<input class="flex-list r3" id="realphone" type="number" value="'+(userinfo?userinfo.mobile:"")+'" >';t+="\t\t</li>";if(gc.filterGoodsId.indexOf(data.goodsId)==-1){t+='\t\t<li class="flex">'}else{t+='\t\t<li class="flex hide">'}t+='\t\t\t<label class="active">送至</label>';t+='\t\t\t<div class="flex-list flex flex-v active">';t+='\t\t\t\t<div class="flex">';t+='\t\t\t\t\t<select class="r3" id="GL1">';t+="\t\t\t\t\t</select>";t+='\t\t\t\t\t<select class="flex-list r3" id="GL2">';t+="\t\t\t\t\t</select>";t+="\t\t\t\t</div>";t+='\t\t\t\t<input class="r3" type="text" id="realaddr" placeholder="详细地址" >';t+="\t\t\t</div>";t+="\t\t</li>";if(gc.filterGoodsId.indexOf(data.goodsId)==-1){t+='\t\t<li class="info"><i class="icon-warning"></i>为了能准确送达您的手中，请确保您所填写的信息的真实性。</li>'}else{t+='\t\t<li class="info"><i class="icon-warning"></i>兑换之前，请详细核实您所填写的手机号是否正确。</li>'}t+="\t</ol>";t+='\t<dl class="goods-view-item">';t+="\t\t<dt><span>商品详情</span></dt>";t+='\t\t<dd class="zdy">'+data.desc.replace(/\/goods_img/g,"//img.11h5.com/score/goods_img")+"</dd>";t+="\t</dl>";t+="</div>";$("#box-11 .box-5").empty().append(t);if(userinfo){if(userinfo.address.indexOf("/")>-1){var args=userinfo.address.split("/");GL.init("GL1","GL2",args[0],args[1]);$("#realaddr").val(args[2])}else{GL.init("GL1","GL2")}}else{GL.init("GL1","GL2")}if(!isHave&&!parseInt(data.goods.real_type)||parseInt(data.goods.real_type)&&!data.goods_number){t='<a href="javascript:;" class="btn disabled">已售完</a>'}else if(parseInt(gc.myPoints)<parseInt(data.goods.point)){t='<a href="javascript:;" class="btn disabled">积分不足</a>'}else if(data.goods.buy_limit&&data.goods.buy_limit<=data.goods.buy_count){t='<a href="javascript:;" class="btn disabled">兑换已达上限</a>'}else if(parseInt(data.goods.day_limit)!=0&&parseInt(data.goods.day_limit)<=parseInt(data.goods.daily_count)){t='<a href="javascript:;" class="btn disabled">今日已达上限</a>'}else if(gc.myVip<data.goods.vip_level){t='<a href="javascript:;" class="btn disabled">VIP等级不足</a>'}else{t='<a href="javascript:;" id="change_btn" onclick="gc.goodsExchange('+id+',0)" class="btn">立即兑换</a>'}$("#box-11 .box-5 .goods-view-head div.flex").append(t);dayLimit=parseInt(data.goods.day_limit);dayCount=parseInt(data.goods.daily_count);$("#scroll").scrollTop(0)})}};gc.goodsExchange=function(id,gameid){function _goodsChange(serverid,servername,roleid,rolename,styleid,addr,phone,name){var _url="";if(serverid){_url="&serverid="+serverid+"&servername="+servername+"&roleid="+roleid+"&rolename="+rolename}if(phone){_url="&address="+addr+"&mobile="+phone+"&realname="+name+"&style="+styleid}var my=$(".mypoint");var obj=$("#goods-number");gc.httpGet(gc.pointGiftURL+"buyGoods&goodsId="+id+_url,function(data){my.html(data.leftScore);obj.html(data.goods_number);gc.myPoints=data.leftScore;if(!data.is_real){if(data.cardSn){var t='<div class="flex gift-dialog"><label>兑换码：</label><div class="r3">'+data.cardSn+'</div></div><p class="gift-dialog-info">复制兑换码，去游戏中使用</p>';sdk.confirmDialog(t,null,"复制",null,function(){setTimeout(function(){sdk.copy(data.cardSn)},50)},"兑换提示")}else{sdk.confirmDialog("恭喜您兑换成功<br>礼包已经通过邮件发放","进入游戏查收","继续逛逛",function(){sdk.createCode(sdk.token,function(params){if(params.code){location.href=sdk.setURLVar("//play.11h5.com/game/?gameid="+data.game_id,"code",params.code)}})},null,"兑换提示")}}else{if(gc.filterGoodsId.indexOf(id)==-1){sdk.confirmDialog("恭喜您兑换成功<br>我们会以快递的方式寄送给您",null,"好的",null,null,"兑换提示")}else{sdk.confirmDialog("恭喜您兑换充值成功<br>充值会有5分钟左右延迟，请耐心等待",null,"好的",null,null,"兑换提示")}}if(dayLimit-dayCount==1){$("#change_btn").removeAttr("onclick").addClass("disabled").html("兑换已达上限")}})}if(gameid==0){var styleid=$("#styleAmount li").find("input:checked").val();var addr="";var phone=$("#realphone").val();var name=$("#realname").val();if($("#styleAmount").length&&!styleid){sdk.confirmDialog("请选择之后再兑换");return}if($("#realname").length&&!name&&gc.filterGoodsId.indexOf(id)==-1){sdk.confirmDialog("请填写您的姓名");return}if($("#GL1").length&&$("#GL1").val()==""&&gc.filterGoodsId.indexOf(id)==-1){sdk.confirmDialog("请选择省份");return}if($("#GL2").length&&$("#GL2").val()==""&&gc.filterGoodsId.indexOf(id)==-1){sdk.confirmDialog("请选择地区");return}if($("#realaddr").length&&$("#realaddr").val()==""&&gc.filterGoodsId.indexOf(id)==-1){sdk.confirmDialog("请填写详细地址");return}if($("#realphone").length&&!phone){sdk.confirmDialog("请填写您的电话号码");return}addr=$("#GL1").val()+"/"+$("#GL2").val()+"/"+$("#realaddr").val();sdk.confirmDialog("您确定要兑换吗？该商品不支持退换，请谨慎选择。","立即兑换","再想想",function(){if(phone){_goodsChange(null,null,null,null,styleid,addr,phone,name)}},null,"兑换提示");return}sdk.confirmDialog("您确定要兑换吗？","立即兑换","再想想",function(){if(gc.pointGiftAutoGameList.indexOf(gameid)>=0){var _userName="";var _userId="";var _serverName="";var _serverId="";gc.httpGet(gc.pointGiftURL+"getRoleList&goodsId="+id,function(data){data=data.roleList;var t='<div class="serviceArea"><div class="flex">';t+="<label>区服：</label>";t+='<select id="serviceChange" class="flex-list">';t+='<option value="0" data-user="">请选择区服</option>';for(var i in data){t+='<option data-userid="'+data[i].roleid+'" data-user="'+data[i].rolename+'" value="'+data[i].serverid+'">'+data[i].servername+"</option>"}t+="</select>";t+="</div>";t+='<div class="flex">';t+="<label>角色：</label>";t+='<input type="text" class="flex-list" id="userNameChange"  disabled readonly>';t+="</div>";t+="</div>";sdk.confirmDialog(t,"确认",null,function(){if(!parseInt(_serverId)){sdk.confirmDialog("缺少必填参数")}else{_goodsChange(_serverId,_serverName,_userId,_userName)}},null,"请先选择区服角色",function(){$("#serviceChange").change(function(){var _this=$(this);var _index=_this.prop("selectedIndex");var _obj=_this.find("option").eq(_index);_userName=_obj.attr("data-user");_userId=_obj.attr("data-userid");_serverName=_obj.html();_serverId=_this.val();$("#userNameChange").val(decodeURIComponent(_userName))})})})}else{_goodsChange()}},null,"兑换提示")};gc.pointGetType=function(number){switch(parseInt(number)){case 1:return"充值";case 2:case 4:return"签到";case 5:return"首充";case 9:return"绑定手机";case 10:return"实名认证";case 99:return"客服补偿增加";default:return"活动"}};gc.backView=function(string){var t='<div class="flex gift-dialog"><label>兑换码：</label><div class="r3">'+string+'</div></div><p class="gift-dialog-info">复制兑换码，去游戏中使用</p>';sdk.confirmDialog(t,null,"复制",null,function(){setTimeout(function(){sdk.copy(string)},50)},"礼包信息")};gc.viewReal=function(name,phone,addr,gname,style,status){var t="";t+='<dl class="realView">';t+="<dd>";t+="<div><label>物品：</label><span>"+gname+"</span></div>";if(style){if(style.indexOf(",")>-1){t+="<div><label>颜色：</label><span>"+style.split(",")[0].split(":")[1]+"</span></div>";t+="<div><label>尺码：</label><span>"+style.split(",")[1].split(":")[1]+"</span></div>"}else{t+="<div><label>款式：</label><span>"+style.split(":")[1]+"</span></div>"}}t+="<div><label>数量：</label><span>1件</span></div>";if(name){t+="<div><label>收件人：</label><span>"+name+"</span></div>"}t+="<div><label>手机号：</label><span>"+phone+"</span></div>";if(addr){t+="<div><label>寄送地址：</label><span>"+addr+"</span></div>"}t+="<div><label>订单状态：</label><span>";switch(status){case 0:t+="订单已提交";break;case 1:t+="已发货";break}t+="</span></div>";t+="</dd>";t+="</dl>";sdk.confirmDialog(t,null,"知道了",null,null,"配送信息")};gc.pointExchangeLog=function(){if(gc.page.pointLost){gc.status.pointExchangeLog=false;gc.httpGet(gc.pointGiftURL+"getScoreConsume&pageNo="+gc.page.pointLost+"&pageSize="+gc.pageSize,function(data){var t="";data=data.consume;if(data.length){for(var i in data){t+='<li class="flex">';t+='<div class="flex-list flex flex-v">';t+="<span>"+new Date(data[i].time*1e3).format("yyyy-MM-dd hh:mm:ss")+"</span>";t+="<strong>"+data[i].goods_name;if(data[i].card_sn){t+="<em onclick=\"gc.backView('"+data[i].card_sn+"')\">（查看）</em>"}if(data[i].is_real){t+="<em onclick=\"gc.viewReal('"+data[i].realname+"','"+data[i].mobile+"','"+data[i].address+"','"+data[i].goods_name+"','"+data[i].style_desc+"',"+data[i].order_status+')">（查看）</em>'}t+="</strong>";t+="</div>";t+="<span>-"+data[i].num+"积分</span>";t+="</li>"}$("#point-change").append(t);if(data.length>=gc.pageSize){gc.page.pointLost++;gc.isReady=true}else{gc.page.pointLost=false;$("#point-change").append('<li class="end"><fieldset><legend>没有更多了</legend></fieldset></li>')}}else if(data==""&&gc.page.pointLost==1){t='<li class="blank flex flex-v"><i class="icon-blank"></i><em>您还没有积分消耗记录</em></li>';$("#point-change").append(t)}})}};gc.pointGetLog=function(){if(gc.page.pointGet){gc.status.pointGetLog=false;gc.httpGet(gc.pointGiftURL+"getScoreIncome&pageNo="+gc.page.pointGet+"&pageSize="+gc.pageSize,function(data){var t="";data=data.income;if(data.length){for(var i in data){t+='<li class="flex">';t+='<div class="flex-list flex flex-v">';t+="<span>"+new Date(data[i].time*1e3).format("yyyy-MM-dd hh:mm:ss")+"</span>";t+="<strong>"+gc.pointGetType(data[i].reason)+"</strong>";t+="</div>";t+="<span>+"+data[i].num+"积分</span>";t+="</li>"}$("#point-get").append(t);$("#point-get .more").remove();if(data.length>=gc.pageSize){gc.page.pointGet++;gc.isReady=true}else{gc.page.pointGet=false;$("#point-get").append('<li class="end"><fieldset><legend>没有更多了</legend></fieldset></li>')}}else if(data==""&&gc.page.pointGet==1){t='<li class="blank flex flex-v"><i class="icon-blank"></i><em>您还没有积分获取记录</em></li>';$("#point-get").append(t)}})}};gc.showScreenIcon=function(){var t='<div id="iconBox" class="screen-tip r5">';t+="<strong>×</strong>";t+='<img class="r10" src="//cdn.11h5.com/static/image/share_logo.jpg" >';t+='<div>先点击 <img src="//cdn.11h5.com/static/image/add_screen_icon.png"><br>再"添加到主屏幕"</div>';t+="</div>";$("body").append(t);$("#iconBox").click(function(){$("#iconBox").css({opacity:"0"});setTimeout(function(){$("#iconBox").remove()},600);var now=new Date;sdk.setItem("screen_last_show_date",now.getDate())})};gc.share=function(){$.get("https://web.11h5.com/share?cmd=getShareDomain&gameid=68&token="+sdk.token+"&v="+Date.now(),function(data){var title=data.title;var desc="海量精品游戏，超值礼包，各种福利，尽在爱微游！";var url=data.entry_url;var imgurl=data.img;if(sdk.getURLVar("chid")){url=sdk.buildURL(url,{chid:sdk.getURLVar("chid")})}if(sdk.getURLVar("subchid")){url=sdk.buildURL(url,{subchid:sdk.getURLVar("subchid")})}gc.shareInfo={title:title,desc:desc,link:url,imgUrl:imgurl};var isFavorite=false;gc.useShare={title:title,desc:desc,link:url,imgUrl:imgurl,trigger:function(res){if(res.shareTo=="favorite"){isFavorite=true}},success:function(){sdk.hideShare();if(!isFavorite||sdk.isQQ()){var isIframe=$("#ad_iframe");if(isIframe.length){gc.postActMessage({cmd:"shareReady"})}}}};if(sdk.isWeixin()){$.get("https://api.11h5.com/common?cmd=getWechatJsTicket&url="+encodeURIComponent(location.href)+"&gameid=68&v="+Date.now(),function(data){data=data["data"];wx.config({debug:false,appId:data["appid"]?data["appid"]:sdk.wxappId,timestamp:data["timestamp"],nonceStr:data["noncestr"],signature:data["sign"],jsApiList:["onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","showOptionMenu","showMenuItems"]});wx.ready(function(){wx.onMenuShareAppMessage(gc.useShare);wx.onMenuShareQQ(gc.useShare);wx.onMenuShareWeibo(gc.useShare)})},"json")}else if(sdk.isQQ()){$.get("https://api.11h5.com/common?cmd=getMobileQQJsTicket&url="+encodeURIComponent(location.href)+"&"+Date.now(),function(data){data=data["data"];mqq.config({debug:false,appId:sdk.qqappId,timestamp:data["timestamp"],nonceStr:data["noncestr"],signature:data["sign"],jsApiList:["onMenuShareAppMessage","onMenuShareQQ","onMenuShareQzone","showOptionMenu","showMenuItems"]});mqq.error(function(res){console.log("mqqerr:"+JSON.stringify(res))});mqq.ready(function(){mqq.onMenuShareAppMessage(gc.useShare);mqq.onMenuShareQQ(gc.useShare);mqq.onMenuShareQzone(gc.useShare)})},"json")}},"json")};gc.init=function(callback){function _success(){gc.apiBaseURL+="token="+sdk.token+"&cmd=";gc.toolInfoURL+="conf?token="+sdk.token+"&cmd=";gc.pointGiftURL+="token="+sdk.token+"&cmd=";gc.enterURL+="token="+sdk.token+"&cmd=";if(sdk.isAvuAPP()){if(sdk.isiOS()){sdk.initWebViewJavascriptBridge(function(){if(window.WebViewJavascriptBridge){window.WebViewJavascriptBridge.callHandler("getUserAccount",function(data){data=data||{};data.uid=sdk.uid;data.token=sdk.token;window.WebViewJavascriptBridge.callHandler("setUserAccount",data)});window.WebViewJavascriptBridge.callHandler("setTitle",document.title)}})}else if(sdk.isAndroid()){sdk.initAndroidAPPShare();var data=window.android.getUserAccount();data=data?JSON.parse(data):{};data.uid=sdk.uid;data.token=sdk.token;window.android.setUserAccount(JSON.stringify(data));window.android.setTitle(document.title)}}callback()}function __success(){if(sdk.isWeixin()||sdk.isQQ()||sdk.isAvuAPP()){sdk.auth()}else{gc.apiBaseURL+="cmd=";callback()}}function _checkCode(){sdk.checkCode(sdk.code,function(data){if(data["token"]){sdk.token=data["token"];sdk.uid=data["uid"];sdk.setItem("token",sdk.token);_success()}else{__success()}})}function _checkToken(){sdk.checkToken(sdk.token,function(data){if(data["uid"]){sdk.uid=data["uid"];_success()}else{sdk.token=null;sdk.removeItem("token");__success()}})}if(sdk.token){_checkToken()}else if(sdk.code){_checkCode()}else{__success()}};if(sdk.isAvuAPP()&&sdk.isAndroid()){if(!sdk.getSession("update")){sdk.setSession("update",1);var appVer=(navigator.userAgent.toLowerCase().match(/avu\/[\d.]+/gi)+"").replace(/[^0-9.]/gi,"");if(appVer){$.get(gc.toolInfoURL+"game?cmd=getAppData&ver=999&"+Date.now(),function(data,status,xhr){if(data){var appChid=(navigator.userAgent.toLowerCase().match(/chid\/[\d.]+/gi)+"").replace(/[^0-9.]/gi,"");if(!appChid){for(var i in data.android){if(data.android[i].enabled&&data.android[i].version!=appVer){if(confirm("发现新版本"+data.android[i].version+":\n"+data.android[i].desc)){window.android.update(data.android[i].url)}break}}}}},"json")}}}if(sdk.getURLVar("token")){var url=sdk.setURLVar(location.href,"token","");sdk.createCode(sdk.getURLVar("token"),function(data){if(data.code){url=sdk.setURLVar(url,"code",data.code)}location.href=url})}if(gc.chid){sdk.getChannelInfo(gc.chid,function(data){if(data.title){document.title=data.title}else{document.title="爱微游 - 游戏中心"}if(!parseInt(data.dlapp)){$("#appBox").parent().remove()}if(parseInt(data.hideCommunity)){$("#jumpBBS").parent().remove()}if(data.isTrial){gc.isTrial=1}})}else{document.title="爱微游 - 游戏中心"}gc.init(function(){if(sdk.isQQ()){$("#appBox").parent().remove();$("#bindPhone").remove()}if(!gc.isStat){gc.isStat=true;sdk.combineStat(sdk.uid,"进入游戏中心",[])}function pageChange(n){var boxIndex="";var navIndex="";var subNavIndex="";var _subNavIndex="";$(".wrap>.icon-return").hide();switch(n){case"":case"#new":case"#active":case"#prize":case"#notice":case"#oldService":case"#newService":boxIndex=1;navIndex=gc.gameNavIndex;gc.getPageBase()}switch(n){case"#guide":case"#agreement":case"#dispute":navIndex=gc.userNavIndex;if(gc.status.userRule){gc.userRule()}}switch(n){case"#gift":case"#user":case"#newService":gc.getUserInfo()}switch(n){case"#market":case"#pramarket":case"#pointView":case"#pointRealView":case"#pointTask":case"#pointRule":case"#pointExchange":case"#pointGet":if(!sdk.token){sdk.auth();return}boxIndex=11;navIndex=gc.shopNavIndex;gc.getUserInfo()}switch(n){case"":if(gc.status.hot){gc.loadGameHot()}if(gc.page.hot){gc.isReady=true}subNavIndex=0;break;case"#new":if(gc.status.new){gc.loadGameNew()}subNavIndex=1;break;case"#oldService":if(gc.status.oldService){gc.loadReadyServer()}if(gc.page.oldService){gc.isReady=true}subNavIndex=3;_subNavIndex=0;break;case"#newService":if(gc.status.newService){gc.loadNewServer()}if(gc.page.newService){gc.isReady=true}subNavIndex=3;_subNavIndex=1;break;case"#active":if(gc.status.active){gc.loadActiveList()}if(gc.page.active){gc.isReady=true}subNavIndex=2;_subNavIndex=0;break;case"#prize":subNavIndex=2;_subNavIndex=1;break;case"#notice":if(gc.status.notice){gc.loadNoticeList()}if(gc.page.notice){gc.isReady=true}subNavIndex=2;if($("#prize-box").length){_subNavIndex=2}else{_subNavIndex=1}break;case"#gift":if(gc.status.gift){gc.loadGiftList()}if(gc.page.gift){gc.isReady=true}boxIndex=2;navIndex=gc.giftNavIndex;break;case"#market":if(gc.status.pointGift){gc.getPointGiftList()}subNavIndex=0;_subNavIndex=0;break;case"#pramarket":subNavIndex=0;_subNavIndex=1;if(gc.status.pointReal){gc.getPointRealList()}break;case"#pointView":if(gc.status.pointGift){location.hash="market"}break;case"#pointRealView":if(gc.status.pointReal){location.hash="pramarket"}break;case"#pointTask":subNavIndex=1;break;case"#pointRule":subNavIndex=3;break;case"#pointExchange":subNavIndex=2;_subNavIndex=1;if(gc.status.pointExchangeLog){gc.pointExchangeLog(1)}break;case"#pointGet":subNavIndex=2;_subNavIndex=0;if(gc.status.pointGetLog){gc.pointGetLog(1)}break;case"#user":boxIndex=3;navIndex=gc.userNavIndex;gc.isRealVerify(function(data){if(data){$("#isVerify").parents("li").find("a").attr("href","javascript:;");$("#isVerify").attr("class","number").text(data.substring(0,3)+"***********"+data.substring(14,18))}});break;case"#myId":boxIndex=5;navIndex=gc.userNavIndex;gc.myIdVerify();break;case"#bind":boxIndex=6;navIndex=gc.userNavIndex;gc.bindMobile();break;case"#rules":boxIndex=7;navIndex=gc.userNavIndex;break;case"#guide":boxIndex=8;break
;case"#agreement":boxIndex=9;break;case"#dispute":boxIndex=10;break;case"#infoview":if(!infoview){location.hash="active"}break}if(n.indexOf("game/")>=0){boxIndex=4;navIndex=gc.gameNavIndex;gc.loadGameInfo(n.split("/")[1])}var obj=$("#box-"+boxIndex+" .show-tab>*").eq(subNavIndex);$("#box-"+boxIndex).removeClass("hide").siblings().addClass("hide");$("#box-"+boxIndex+" ol.nav li").eq(subNavIndex).addClass("active").siblings().removeClass("active");obj.removeClass("hide").siblings().addClass("hide");switch(n){case"#newService":case"#oldService":case"#active":case"#prize":case"#notice":case"#pointExchange":case"#pointGet":case"#market":case"#pramarket":obj.find(".subnav li").eq(_subNavIndex).addClass("active").siblings().removeClass("active");obj.find(".subtab>*").eq(_subNavIndex).removeClass("hide").siblings().addClass("hide")}switch(n){case"#pointView":case"#pointRealView":$(".box .box-5").removeClass("hide").siblings().addClass("hide");$(".wrap>.icon-return").show()}$(".footer-nav li").eq(navIndex).addClass("active").siblings().removeClass("active")}pageChange(location.hash);$(window).on("hashchange",function(){pageChange(location.hash);gc.setAppTitle(document.title);gc.subheight=0});if(sdk.token){gc.httpGet(gc.enterURL+"enter",function(data){if((!data.isGetBindIdcardPrize||!data.isGetBindPhonePrize)&&location.hash!="#pointTask"){$(".mknav li").eq(1).find("a").append('<em class="r50"></em>')}var t='<li class="flex">';t+='<em class="r50"><i class="icon-sign"></i></em>';t+='<div class="flex-list flex flex-v">';t+='<strong>签到<em class="tags-coupon">日常</em></strong>';t+='<p>明日再来即可获得<span id="signPoint">';if(parseInt(data.isSignupToday)){t+=gc.pointList(data.consecutiveSignup)}else{t+=gc.pointList(data.consecutiveSignup+1)}t+="</span>积分</p>";t+="</div>";if(parseInt(data.isSignupToday)){gc.status.sign=true;t+='<a href="javascript:;" class="btn disabled">已完成</a>';$(".signtype").addClass("disabled").html("已签到");$("#sign i.icon-right").html("已签到").addClass("number").removeClass("icon-right");sdk.setItem("sign",data.consecutiveSignup)}else{sdk.removeItem("sign");sdk.removeItem("sign_time");$(".icon-market").append('<em class="r50"></em>');$(".signtype").append('<i class="r50"></i>');t+='<a href="javascript:;" id="signPointBtn" onclick="gc.signUp()" class="btn">+'+gc.pointList(data.consecutiveSignup)+"积分</a>"}t+="</li>";t+='<li class="flex">';t+='<em class="r50"><i class="icon-pay"></i></em>';t+='<div class="flex-list flex flex-v">';t+='<strong>每日首充<em class="tags-coupon">日常</em></strong>';t+="<p>每日首次充值任意一款游戏</p>";t+="</div>";if(parseInt(data.isGetFirstPayScore)){t+='<a href="javascript:;" class="btn disabled">已完成</a>'}else{t+='<a href="javascript:;" onclick="gc.firstPay()" class="btn">+50积分</a>'}t+="</li>";t+='<li class="flex">';t+='\t<em class="r50"><i class="icon-pays"></i></em>';t+='\t<div class="flex-list flex flex-v">';t+='\t\t<strong>充值<em class="tags-coupon">长期</em></strong>';t+="\t\t<p>每充值1元即可获得10积分</p>";t+="\t</div>";t+='\t<a href="#" class="btn">去完成</a>';t+="</li>";$(".task").empty().append(t);gc.isBindPhone(function(phone){var t='<li class="flex">';t+='\t<em class="r50"><i class="icon-mobile"></i></em>';t+='\t<div class="flex-list flex flex-v">';t+='\t\t<strong>绑定手机<em class="tags-coupon">一次性</em></strong>';t+="\t\t<p>完成绑定即可获得1000积分</p>";t+="\t</div>";if(data.isGetBindPhonePrize){t+='\t<a href="javascript:;" class="btn disabled">已完成</a>'}else if(phone){t+='\t<a href="javascript:;" id="bindPhoneStatus" onclick="gc.getBindPhonePrize()" class="btn">领取<i class="r50"></i></a>'}else{t+='\t<a href="#bind" id="bindPhoneStatus" class="btn">+1000积分<i class="r50"></i></a>'}t+="</li>";$(".task").append(t)});gc.isRealVerify(function(card){var t='<li class="flex">';t+='\t<em class="r50"><i class="icon-user"></i></em>';t+='\t<div class="flex-list flex flex-v">';t+='\t\t<strong>实名认证<em class="tags-coupon">一次性</em></strong>';t+="\t\t<p>完成认证即可获得1000积分</p>";t+="\t</div>";if(data.isGetBindIdcardPrize){t+='\t<a href="javascript:;" class="btn disabled">已完成</a>'}else if(card){t+='\t<a href="javascript:;" id="bindIdStatus" onclick="gc.getBindIdPrize()" class="btn">领取<i class="r50"></i></a>'}else{t+='\t<a href="#myId" id="bindIdStatus" class="btn">+1000积分<i class="r50"></i></a>'}t+="</li>";$(".task").append(t)})});sdk.checkDevice()}$(".sort ol").on("click","li",function(){var _this=$(this);var _index=_this.index();var _type=_this.attr("data-type");_this.addClass("active").siblings().removeClass("active");if(_index!=0){var _list=_this.html();if(_type=="gift"){for(var i=0;i<$("#goods-item li").length;i++){var _obj=$("#goods-item li").eq(i);var _key=_obj.attr("data-key");if(_list.indexOf(_key)>=0){_obj.show()}else{_obj.hide()}}}else if(_type=="real"){var count=0;for(var i=0;i<$("#real-item li").length;i++){var _obj=$("#real-item li").eq(i);var _key=parseInt(_obj.attr("data-key"));if(_key<=gc.myPoints){count++;_obj.show()}else{_obj.hide()}}if(!count){$("#real-item").append('<li class="blank flex flex-v"><i class="icon-blank"></i><em>您当前的积分没有可兑换物品</em></li>')}}}else{if(_type=="gift"){$("#goods-item li").show()}else if(_type=="real"){$("#real-item li.blank").remove();$("#real-item li").show()}}});$("#jumpBBS").click(function(){gc.setAppTitle("爱微游 - 游戏社区","https://buluo.qq.com/mobile/barindex.html?_bid=128&_wv=1027&bid=397446")});if(sdk.isAvuAPP()){$("#appBox").append('<li id="clean"><a href="javascript:;" class="flex"><div class="r50 c-down"><i class="icon-down"></i></div><span class="flex-list">清理缓存</span></a></li>');$("#clean").click(function(){clearCache()});if(sdk.isAndroid()){sdk.setItem("down_ready","1");sdk.combineStat(sdk.uid,"APP进入游戏中心",[{"广告位":"安卓用户"}])}else if(sdk.isiOS()){sdk.combineStat(sdk.uid,"APP进入游戏中心",[{"广告位":"苹果用户"}])}}else{if(!sdk.isiOS()){$("#appBox").append('<li id="downAvyApp"><a href="javascript:;" class="flex"><div class="r50 c-down"><i class="icon-down"></i></div><span class="flex-list">APP下载</span></a></li>');$("#downAvyApp").click(function(){if(sdk.isiOS()){}else{if(sdk.isMobile()){location.href="//a.app.qq.com/o/simple.jsp?pkgname=com.vutimes.app"}else{$("body").append('<iframe style="display:none;" src="//cdn.11h5.com/static/app/android/aiweiyou_17.0.apk"></iframe>')}}})}if(sdk.isAndroid()&&!gc.chid){if(!sdk.getItem("down_ready")){if(!sdk.getItem("down_key")||sdk.getItem("down_key")!=(new Date).getDate()){$(".ad_download").removeClass("hide");$(".ad_download>i").click(function(){$(".ad_download").remove();sdk.setItem("down_key",(new Date).getDate())});$(".ad_download>a").click(function(){sdk.combineStat(sdk.uid,"APP免费下载",[{"广告位":"安卓用户"}]);$("#downAvyApp").trigger("click");$(".ad_download>i").trigger("click")})}}}}gc.httpGet(gc.apiBaseURL+"getRemindDot",function(data){var data=data.remind;if(data[1]){$(".footer-nav i.icon-gift").append('<em class="r50"></em>')}if(data[3]){$("#box-1>ol.nav li").eq(1).find("a").append('<em class="r50"></em>')}});function delectDot(type){gc.httpGet(gc.apiBaseURL+"delRemindDot&type="+type,function(){})}$(".mknav a").click(function(e){var _this=$(e.target).parents("li.flex-list");if(_this.find("em").length){_this.find("em").remove()}});$("#box-1>ol.nav").on("click","li",function(){if($(this).find("em").length){delectDot($(this).attr("data-type"));$(this).find("em").remove()}});$(".footer-nav").on("click","li",function(){if($(this).find("i>em").length){$(this).find("i>em").remove();if(parseInt($(this).attr("data-type"))){delectDot($(this).attr("data-type"))}}});if(!sdk.token){$("#lgout").text("登录")}$("#lgout").off().click(function(){if(sdk.token){sdk.removeItem("token");location.href=sdk.setURLVar(location.href,"code","")}else{sdk.auth()}});$("#bindId").click(function(){if(sdk.token){if(!$("#isVerify").html()){location.hash="myId"}}else{sdk.confirmDialog("实名认证需要登录后才能操作","现在就去","知道了",function(){sdk.auth()},null)}});$("#bindPhone").click(function(){if(sdk.token){if(!$("#isBind").html()){location.hash="bind"}}else{sdk.confirmDialog("绑定手机需要登录后才能操作","现在就去","知道了",function(){sdk.auth()},null)}});gc.setAppTitle(document.title);function pageScroll(scrollTop,boxHeight,maxScrollHeight){if(scrollTop+boxHeight>=maxScrollHeight-50){if(gc.isReady){gc.isReady=false;switch(location.hash){case"":gc.loadGameHot();break;case"#notice":gc.loadNoticeList();break;case"#newService":gc.loadNewServer();break;case"#oldService":gc.loadReadyServer();break;case"#gift":gc.loadGiftList();break;case"#pointGet":gc.pointGetLog();break;case"#pointExchange":gc.pointExchangeLog();break}}}}function addQrcode(url){var t='<div class="flex flex-v quickQrcode">';t+='<img src="'+(url?url:"//cdn.11h5.com/static/image/qrcode_plus.jpg")+'">';t+="<p>微信扫码 在手机上玩</p>";t+="</div>";$(".wrap-box").append(t)}if($(window).width()>750&&!sdk.isAvuAPP()){$(".downQrcode").mouseenter(function(){if(!$(".downQrcode>div").html()){sdk.createQRCode("//a.app.qq.com/o/simple.jsp?pkgname=com.vutimes.app",120,120,function(data){$(".downQrcode>div").append('<img src="'+data+'"  >').addClass("active")})}else{$(".downQrcode>div").removeClass("hide").addClass("active")}}).mouseleave(function(){$(".downQrcode>div").addClass("hide").removeClass("active")});if(gc.chid){sdk.getChannelInfo(gc.chid,function(data){if(data&&data.replaceQrcodeUrl){addQrcode(data.replaceQrcodeUrl);$(".topBar").remove()}else{addQrcode()}})}else{addQrcode()}document.getElementById("scroll").onscroll=function(){var scrollTop=document.getElementById("scroll").scrollTop;if(scrollTop+$(".wrap").height()>=gc.subheight){for(var i=0;i<$("#scroll>div").length;i++){if($("#scroll>div").eq(i).attr("class").indexOf("hide")==-1){gc.subheight=$("#scroll>div").eq(i).height()}}}pageScroll(scrollTop,$(".wrap").height(),gc.subheight)}}else{window.onscroll=function(){var scrollTop=document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop;pageScroll(scrollTop,gc.height,$(document).height())}}if(sdk.isWeixin()||sdk.isQQ()){gc.share()}});