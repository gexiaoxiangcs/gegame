(function () {
    var sdk = window.AWY_SDK || {};
    sdk.hostVersion = "4.0 build 201709181450";
    sdk.wxappId = "wx0437200439052cde";
    sdk.wxopenId = "wx22f69b39568e9cb3";
    sdk.qqappId = "200516427";
    sdk.gameId = 0;
    sdk.shareCallback = null;
    sdk.readyCallback = null;
    sdk.readyMsgList = [];
    sdk.code = null;
    sdk.token = null;
    sdk.uid = null;
    sdk.shareDatas = null;
    sdk.isFocus = false;
    sdk.isHideFocus = false;
    sdk.isBridgeShareReady = false;
    sdk.channelInfo = null;
    sdk.getShareDomain = null;
    sdk.getPreventInfo = null;
    sdk.isTrial = 1;
    sdk.initHost = function (callback, type) {
        if (!sdk.code) {
            sdk.code = sdk.getURLVar("code")
        }
        if (!sdk.gameId && !type) {
            sdk.gameId = sdk.getURLVar("gameid")
        }
        sdk.token = sdk.getItem("token");

        function __checkSuccess() {
            var fuid = sdk.getURLVar("fuid");
            if (fuid) {
                $.get("https://user.11h5.com/wechat?cmd=applyFriend&token=" + sdk.token + "&fuid=" + fuid + "&" + Date.now(), function (data) {})
            }
            if (sdk.isAvuAPP()) {
                if (sdk.isiOS()) {
                    sdk.initWebViewJavascriptBridge(function () {
                        if (window.WebViewJavascriptBridge) {
                            window.WebViewJavascriptBridge.callHandler("getUserAccount", function (data) {
                                data = data || {};
                                data.uid = sdk.uid;
                                data.token = sdk.token;
                                window.WebViewJavascriptBridge.callHandler("setUserAccount", data)
                            });
                            window.WebViewJavascriptBridge.callHandler("setTitle", document.title)
                        }
                    })
                } else if (sdk.isAndroid()) {
                    sdk.initAndroidAPPShare();
                    var data = window.android.getUserAccount();
                    data = data ? JSON.parse(data) : {};
                    data.uid = sdk.uid;
                    data.token = sdk.token;
                    window.android.setUserAccount(JSON.stringify(data));
                    window.android.setTitle(document.title)
                }
            }
            sdk.statOnline();
            callback()
        }

        function __checkCode() {
            sdk.checkCode(sdk.code, function (data) {
                sdk.setItem("code", sdk.code);
                if (data["token"]) {
                    sdk.token = data["token"];
                    sdk.uid = data["uid"];
                    sdk.isFocus = data["focus"] > 0;
                    sdk.isTrial = data["trial"];
                    sdk.setItem("token", sdk.token);
                    __checkSuccess()
                } else {
                    if (sdk.token) {
                        __checkToken()
                    } else {
                        sdk.auth()
                    }
                }
            })
        }

        function __checkToken() {
            sdk.checkToken(sdk.token, function (data) {
                if (data["uid"]) {
                    sdk.uid = data["uid"];
                    sdk.isFocus = data["focus"] > 0;
                    sdk.isTrial = data["trial"];
                    __checkSuccess()
                } else {
                    if (sdk.getURLVar("tokenkey") && sdk.isDesktopApp()) {
                        __checkTokenKey()
                    } else {
                        sdk.removeItem("token");
                        sdk.auth()
                    }
                }
            })
        }

        function __checkTokenKey() {
            $.get("https://api.11h5.com/login?cmd=getTokenByTokenKey&tokenkey=" + sdk.getURLVar("tokenkey"), function (data) {
                if (data.token) {
                    sdk.setItem("token", data.token);
                    sdk.token = sdk.getItem("token");
                    __checkToken()
                } else {
                    sdk.confirmDialog(data.error)
                }
            }, "json")
        }
        if (sdk.getURLVar("tokenkey") && sdk.isDesktopApp()) {
            if (sdk.token) {
                __checkToken()
            } else {
                __checkTokenKey()
            }
        } else {
            if (sdk.code && sdk.code != sdk.getItem("code")) {
                __checkCode()
            } else if (sdk.token) {
                __checkToken()
            } else {
                sdk.auth()
            }
        }
    };
    sdk.auth = function (nocache) {
        if (sdk.isWeixin()) {
            sdk.redirectAuth("wx", sdk.gameId, nocache)
        } else if (sdk.isQQ()) {
            sdk.redirectAuth("mqq", sdk.gameId, nocache)
        } else {
            if (sdk.getURLVar("trial")) {
                $.get("https://login.11h5.com/account/api.php?c=new_login&d=getTrialUid&gameid=" + sdk.gameId, function (data) {
                    var url = location.href;
                    if (sdk.getURLVar("chid")) {
                        url = sdk.buildURL(url, {
                            chid: sdk.getURLVar("chid")
                        })
                    }
                    sdk.createCode(data["token"], function (code) {
                        if (code.code) {
                            url = sdk.buildURL(url, {
                                code: code.code
                            })
                        }
                        location.href = url
                    })
                }, "json")
            } else {
                if (sdk.isAvuAPP()) {
                    if (sdk.isiOS()) {
                        sdk.initWebViewJavascriptBridge(function () {
                            if (window.WebViewJavascriptBridge) {
                                window.WebViewJavascriptBridge.callHandler("setTitle", "登录爱微游")
                            }
                        })
                    } else if (sdk.isAndroid()) {
                        window.android.setTitle("登录爱微游")
                    }
                    sdk.loadLoginBox(sdk.wxAppLogin, null, sdk.qqLogin, sdk.sinaLogin, sdk.ygLogin, sdk.ygLogin)
                } else {
                    var chid = parseInt(sdk.getURLVar("chid"));
                    if (chid) {
                        sdk.getChannelInfo(chid, function (data) {
                            if (typeof data.loginHideOption == "undefined") {
                                sdk.loadLoginBox(null, sdk.wxQrcodeLogin, sdk.qqLogin, sdk.sinaLogin, sdk.ygLogin, sdk.ygLogin)
                            } else {
                                var loginOption = data.loginHideOption.split(",");
                                sdk.loadLoginBox(null, loginOption[0] == 0 ? sdk.wxQrcodeLogin : null, loginOption[1] == 0 ? sdk.qqLogin : null, loginOption[2] == 0 ? sdk.sinaLogin : null, loginOption[3] == 0 ? sdk.ygLogin : null, loginOption[4] == 0 ? sdk.ygLogin : null)
                            }
                        })
                    } else {
                        sdk.loadLoginBox(null, sdk.wxQrcodeLogin, sdk.qqLogin, sdk.sinaLogin, sdk.ygLogin, sdk.ygLogin)
                    }
                }
            }
        }
    };
    sdk.wxQrcodeLogin = function () {
        sdk.redirectAuth("wxqrcode", sdk.gameId)
    };
    sdk.qqLogin = function () {
        sdk.redirectAuth("qq", sdk.gameId)
    };
    sdk.sinaLogin = function () {
        sdk.redirectAuth("sina", sdk.gameId)
    };
    sdk.wxAppLogin = function () {
        if (sdk.isiOS()) {
            sdk.initWebViewJavascriptBridge(function () {
                if (window.WebViewJavascriptBridge) {
                    WebViewJavascriptBridge.callHandler("wxAuth", function (data) {
                        if (data) {
                            if (!parseInt(data["uid"]) && data["uid"] != undefined) {
                                location.href = "http://play.11h5.com/redirectauth/?type=app"
                            } else {
                                location.href = sdk.buildURL(location.href, {
                                    token: data["token"],
                                    uid: data["uid"],
                                    code: null
                                })
                            }
                        } else {
                            sdk.confirmDialog("已取消授权登录")
                        }
                    })
                }
            })
        } else if (sdk.isAndroid()) {
            window.__avuAuthCallback = function (data) {
                if (data) {
                    data = JSON.parse(data);
                    if (!parseInt(data["uid"]) && data["uid"] != undefined) {
                        location.href = "http://play.11h5.com/redirectauth/?type=app"
                    } else {
                        location.href = sdk.buildURL(location.href, {
                            token: data["token"],
                            uid: data["uid"],
                            code: null
                        })
                    }
                } else {
                    sdk.confirmDialog("已取消授权登录")
                }
            };
            window.android.wxAuth("__avuAuthCallback")
        }
    };
    sdk.redirectAuth = function (pf, gameid, nocache) {
        var url = "https://login.11h5.com/account/api.php?c=new_login&d=redirectAuth&pf=" + pf + "&gameid=" + gameid;
        if (location.protocol == "https:") {
            url += "&ssl=1"
        }
        if (nocache) {
            url += "&nocache=1"
        }
        if (!gameid) {
            var _url = location.href;
            if (_url.indexOf("#") >= 0) {
                _url = _url.split("#")[0]
            }
            _url = sdk.setURLVar(_url, "code", "");
            url += "&back_url=" + encodeURIComponent(_url)
        }
        if (sdk.getURLVar("trial")) {
            url += "&trial=1&trialBind=1&token=" + sdk.token
        }
        var trans = ["chid", "subchid", "fuid", "share_from"];
        var args = {};
        var query = sdk.getURLQuery(location.href);
        var paramKeys = Object.keys(query);
        for (var i in paramKeys) {
            var key = paramKeys[i];
            if (trans.indexOf(key) >= 0 || key.indexOf("cp_") == 0) {
                args[key] = query[key]
            }
        }
        url = sdk.buildURL(url, args);
        location.href = url
    };
    sdk.createCode = function (token, callback) {
        $.get("https://api.11h5.com/login?cmd=getCodeByToken&token=" + token + "&" + Date.now(), function (data) {
            callback(data)
        }, "json")
    };
    sdk.checkCode = function (code, callback) {
        $.get("https://api.11h5.com/login?cmd=checkCode&code=" + code + "&" + Date.now(), function (data) {
            callback(data)
        }, "json")
    };
    sdk.getUserToken = function (token, callback) {
        $.get("https://api.11h5.com/login?cmd=getUserToken&token=" + token + "&" + Date.now(), function (data) {
            callback(data)
        }, "json")
    };
    sdk.checkToken = function (token, callback) {
        $.get("https://api.11h5.com/login?cmd=checkToken&token=" + token + "&" + Date.now(), function (data) {
            callback(data)
        }, "json")
    };
    sdk.getChannelInfo = function (chid, callback) {
        if (sdk.channelInfo) {
            callback(sdk.channelInfo)
        } else {
            $.get("https://api.11h5.com/conf?cmd=getCpsConfig&chid=" + chid + "&" + Date.now(), function (data) {
                sdk.channelInfo = data.config;
                callback(sdk.channelInfo)
            }, "json")
        }
    };
    sdk.checkDevice = function () {
        $.get("https://api.11h5.com/conf?cmd=checkDevice&token=" + sdk.token + "&" + Date.now(), function () {}, "json")
    };
    sdk.wxReady = function () {
        if (sdk.readyCallback) {
            sdk.readyCallback()
        }
        sdk.readyCallback = null;
        for (var i in sdk.readyMsgList) {
            sdk.execMessage(sdk.readyMsgList[i])
        }
        sdk.readyMsgList = null
    };
    sdk.wxInit = function (shareCallback, readyCallback) {
        sdk.shareCallback = shareCallback;
        sdk.readyCallback = readyCallback;
        $.get("https://web.11h5.com/share?cmd=getShareDomain&gameid=" + sdk.gameId + "&token=" + sdk.token + "&" + Date.now(), function (data) {
            var shareURL = data["shareURL"] || "";
            var shareTitle = decodeURIComponent(data["title"]);
            var shareDesc = decodeURIComponent(data["desc"]);
            var shareImg = data["img"];
            var entryURL = data["entry_url"];
            var timeline = data["timeline"];
            var isMsgUseShareURL = false;
            if (shareURL.indexOf("@") == 0) {
                shareURL = shareURL.replace("@", "");
                isMsgUseShareURL = true
            } else if (shareURL) {
                shareURL = sdk.setURLVar(shareURL, "gameid", sdk.gameId)
            }
            var msgURL = sdk.setURLVar(entryURL, "share_from", "msg");
            if (sdk.uid) {
                if (shareURL) {
                    shareURL = sdk.setURLVar(shareURL, "fuid", sdk.uid)
                }
                msgURL = sdk.setURLVar(msgURL, "fuid", sdk.uid)
            }
            var chid = parseInt(sdk.getURLVar("chid"));
            if (chid > 0) {
                if (shareURL) {
                    shareURL = sdk.setURLVar(shareURL, "chid", chid)
                }
                msgURL = sdk.setURLVar(msgURL, "chid", chid);
                var subchid = sdk.getURLVar("subchid");
                if (subchid) {
                    if (shareURL) {
                        shareURL = sdk.setURLVar(shareURL, "subchid", subchid)
                    }
                    msgURL = sdk.setURLVar(msgURL, "subchid", subchid)
                }
            }
            sdk.getShareDomain = {
                title: shareTitle,
                text: shareDesc,
                image: shareImg
            };
            sdk.shareDatas = [{
                wxsession: true,
                wxtimeline: timeline && shareURL ? true : false,
                qq: false,
                qzone: false
            }, {
                title: shareTitle,
                text: shareDesc,
                image: shareImg,
                url: msgURL,
                wxsession: isMsgUseShareURL && shareURL ? sdk.setURLVar(shareURL, "share_from", "msg") : msgURL,
                wxtimeline: shareURL ? sdk.setURLVar(shareURL, "share_from", "timeline") : msgURL,
                qq: msgURL,
                qzone: msgURL
            }];
            if (sdk.isWeixin()) {
                $.get("https://api.11h5.com/common?cmd=getWechatJsTicket&url=" + encodeURIComponent(location.href) + "&gameid=" + sdk.gameId + "&appid=" + sdk.wxappId + "&" + Date.now(), function (data) {
                    data = data["data"];
                    wx.config({
                        debug: false,
                        appId: data["appid"] ? data["appid"] : sdk.wxappId,
                        timestamp: data["timestamp"],
                        nonceStr: data["noncestr"],
                        signature: data["sign"],
                        jsApiList: ["onMenuShareTimeline", "onMenuShareAppMessage", "onMenuShareQQ", "onMenuShareWeibo", "hideOptionMenu", "showOptionMenu", "hideMenuItems", "showMenuItems", "chooseWXPay", "closeWindow", "startRecord", "stopRecord", "playVoice", "stopVoice", "onVoicePlayEnd", "uploadVoice", "downloadVoice"]
                    });
                    wx.ready(function () {
                        var isFavorite = false;
                        sdk.shareDatas = [{
                            title: sdk.getShareDomain.text,
                            link: sdk.setURLVar(shareURL, "share_from", "timeline"),
                            imgUrl: sdk.getShareDomain.image,
                            trigger: function (res) {}, success: function (res) {
                                sdk.confirmShare();
                                if (sdk.shareCallback) {
                                    sdk.shareCallback("onMenuShareTimeline")
                                }
                            }, cancel: function (res) {}, fail: function (res) {}
                        }, {
                            title: shareTitle,
                            desc: shareDesc,
                            link: isMsgUseShareURL && shareURL ? sdk.setURLVar(shareURL, "share_from", "msg") : msgURL,
                            imgUrl: shareImg,
                            trigger: function (res) {
                                isFavorite = res.shareTo == "favorite"
                            }, success: function (res) {
                                if (!isFavorite) {
                                    if (sdk.shareCallback) {
                                        sdk.shareCallback("onMenuShareAppMessage")
                                    }
                                }
                            }, cancel: function (res) {}, fail: function (res) {}
                        }, {
                            title: shareTitle,
                            desc: shareDesc,
                            link: msgURL,
                            imgUrl: shareImg,
                            trigger: function (res) {}, complete: function (res) {}, success: function (res) {}, cancel: function (res) {}, fail: function (res) {}
                        }, {
                            title: shareTitle,
                            desc: shareDesc,
                            link: msgURL,
                            imgUrl: shareImg,
                            trigger: function (res) {}, complete: function (res) {}, success: function (res) {}, cancel: function (res) {}, fail: function (res) {}
                        }];
                        wx.onMenuShareTimeline({
                            title: sdk.getShareDomain.text,
                            link: sdk.setURLVar(shareURL, "share_from", "timeline"),
                            imgUrl: sdk.getShareDomain.image,
                            trigger: function (res) {}, success: function (res) {
                                sdk.confirmShare();
                                if (sdk.shareCallback) {
                                    sdk.shareCallback("onMenuShareTimeline")
                                }
                            }, cancel: function (res) {}, fail: function (res) {}
                        });
                        wx.onMenuShareAppMessage(sdk.shareDatas[1]);
                        wx.onMenuShareQQ(sdk.shareDatas[2]);
                        wx.onMenuShareWeibo(sdk.shareDatas[3]);
                        var hideMenuList = ["menuItem:share:weiboApp", "menuItem:share:facebook", "menuItem:share:qq", "menuItem:share:QZone"];
                        if (!timeline || !shareURL) {
                            hideMenuList.push("menuItem:share:timeline")
                        }
                        wx.hideMenuItems({
                            menuList: hideMenuList
                        });
                        sdk.wxReady()
                    })
                }, "json")
            } else if (sdk.isQQ()) {
                $.get("https://api.11h5.com/common?cmd=getMobileQQJsTicket&url=" + encodeURIComponent(location.href) + "&" + Date.now(), function (data) {
                    data = data["data"];
                    mqq.config({
                        debug: false,
                        appId: sdk.qqappId,
                        timestamp: data["timestamp"],
                        nonceStr: data["noncestr"],
                        signature: data["sign"],
                        jsApiList: ["onMenuShareTimeline", "onMenuShareAppMessage", "onMenuShareQQ", "onMenuShareQzone", "hideOptionMenu", "showOptionMenu", "hideMenuItems", "showMenuItems", "closeWindow"]
                    });
                    mqq.error(function (res) {
                        console.log("mqqerr:" + JSON.stringify(res))
                    });
                    mqq.ready(function () {
                        mqq.hideMenuItems({
                            menuList: ["menuItem:share:appMessage", "menuItem:share:timeline", "menuItem:share:QZone"]
                        });
                        sdk.shareDatas = [{
                            title: shareDesc,
                            link: shareURL ? sdk.setURLVar(shareURL, "share_from", "timeline") : msgURL,
                            imgUrl: shareImg,
                            success: function (res) {
                                sdk.confirmShare();
                                if (sdk.shareCallback) {
                                    sdk.shareCallback("onMenuShareTimeline")
                                }
                            }, cancel: function (res) {}
                        }, {
                            title: shareTitle,
                            desc: shareDesc,
                            link: isMsgUseShareURL && shareURL ? sdk.setURLVar(shareURL, "share_from", "msg") : msgURL,
                            imgUrl: shareImg,
                            success: function (res) {
                                if (sdk.shareCallback) {
                                    sdk.shareCallback("onMenuShareAppMessage")
                                }
                            }, cancel: function (res) {}
                        }, {
                            title: shareTitle,
                            desc: shareDesc,
                            link: isMsgUseShareURL && shareURL ? sdk.setURLVar(shareURL, "share_from", "msg") : msgURL,
                            imgUrl: shareImg,
                            success: function (res) {
                                if (sdk.shareCallback) {
                                    sdk.shareCallback("onMenuShareQQ")
                                }
                            }, cancel: function (res) {}
                        }, {
                            title: shareTitle,
                            desc: shareDesc,
                            link: msgURL,
                            imgUrl: shareImg,
                            success: function (res) {
                                if (sdk.shareCallback) {
                                    sdk.shareCallback("onMenuShareQzone")
                                }
                            }, cancel: function (res) {}
                        }];
                        mqq.onMenuShareTimeline(sdk.shareDatas[0]);
                        mqq.onMenuShareAppMessage(sdk.shareDatas[1]);
                        mqq.onMenuShareQQ(sdk.shareDatas[2]);
                        mqq.onMenuShareQzone(sdk.shareDatas[3]);
                        sdk.wxReady()
                    })
                }, "json")
            } else {
                if (sdk.isAvuAPP()) {
                    sdk.wxAppInit()
                } else {
                    sdk.wxReady()
                }
            }
        }, "json")
    };
    sdk.wxAppInit = function () {
        if (sdk.isiOS()) {
            sdk.initWebViewJavascriptBridge(function () {
                if (window.WebViewJavascriptBridge) {
                    window.WebViewJavascriptBridge.callHandler("setShare", sdk.shareDatas[0]);
                    window.WebViewJavascriptBridge.callHandler("setShareContent", sdk.shareDatas[1]);
                    sdk.wxReady()
                }
            })
        } else if (sdk.isAndroid()) {
            window.android.setShare(JSON.stringify(sdk.shareDatas[0]));
            window.android.setShareContent(JSON.stringify(sdk.shareDatas[1]));
            sdk.wxReady()
        }
    };
    sdk.userPlay = function () {
        if (sdk.token) {
            var url = "https://api.11h5.com/userPlay?cmd=add&gameid=" + sdk.gameId + "&token=" + sdk.token;
            var chid = sdk.getURLVar("chid");
            var subchid = sdk.getURLVar("subchid");
            var from = sdk.getURLVar("share_from");
            if (chid) {
                url += "&chid=" + chid
            }
            if (subchid) {
                url += "&subchid=" + subchid
            }
            if (from) {
                url += "&from=" + from
            }
            $.get(url + "&" + Date.now(), function (data) {})
        }
    };
    sdk.confirmShare = function () {
        $.get("https://web.11h5.com/share?cmd=confirmShare&gameid=" + sdk.gameId + "&" + Date.now(), function (data) {}, "json")
    };
    sdk.showFocus = sdk.focus = function (args) {
        function loadFocus(e) {
            e = e || {};
            if (!$("#focus").length) {
                if (e.title) {
                    switch (parseInt(e.title)) {
                        case 1:
                            sdk.focus_title = "进入“爱微游Plus”";
                            break
                    }
                }
                if (sdk.channelInfo) {
                    if (sdk.channelInfo.replaceQrcodeUrl) {
                        sdk.qrcode_default = sdk.channelInfo.replaceQrcodeUrl;
                        sdk.focus_title = "更多精彩 请关注公众号"
                    }
                } else if (e.url) {
                    sdk.qrcode_default = e.url
                }
                var t = '<div id="focus" class="mask focus">';
                t += "<div>";
                t += "<div>";
                if (!sdk.channelInfo) {
                    t += '<img src=" ' + (sdk.logo_default ? sdk.logo_default : "//cdn.11h5.com/static/image/focus/banner_logo.png") + '" >'
                }
                t += "</div>";
                t += "<div><h1>" + (sdk.focus_title ? sdk.focus_title : "关注“爱微游Plus”") + '</h1><img src="' + (sdk.qrcode_default ? sdk.qrcode_default : "//cdn.11h5.com/static/image/qrcode_plus_clear.png") + '" ><span>';
                if (e.desc) {
                    t += e.desc
                } else {
                    if (sdk.isQQ() || sdk.isWeixin()) {
                        t += "长按识别二维码"
                    } else {
                        t += "微信扫一扫二维码"
                    }
                }
                t += "</span></div>";
                t += "</div></div>";
                $("body").append(t);
                $("#focus").off().click(function () {
                    $("#focus").remove()
                })
            }
        }
        if (args) {
            loadFocus(args)
        } else {
            if (sdk.isQQ()) {
                location.href = "https://share.mp.qq.com/cgi/share.php?uin=1287591962&account_flag=16849177&jumptype=1&card_type=public_account"
            } else {
                loadFocus()
            }
        }
    };
    sdk.showShare = sdk.share = function (args) {
        args = args || {};
        var t = '<div id="share-square" onclick="sdk.hideShare()" class="mask share-square">';
        t += "<div>";
        t += '<img src="' + (args.finger ? args.finger : "https://cdn.11h5.com/static/image/share_finger.png") + '">';
        t += '<img src="' + (args.body ? args.body : "https://cdn.11h5.com/static/image/share_finger_body.png") + '">';
        t += '<span><i class="icon-share"></i>';
        if (sdk.isQQ()) {
            t += "发送到QQ群"
        } else {
            t += "发送到微信群"
        }
        t += "</span>";
        t += "</div></div>";
        $("body").append(t)
    };
    sdk.hideShare = function () {
        $("#share-square").remove()
    };
    sdk.logout = function () {
        sdk.removeItem("token");
        sdk.auth(true)
    };
    sdk.showFriend = function () {
        $("body").append('<div id="friendFrameDiv" style="width: 100%; height: 100%; position: absolute; top: 0px; left: 0px;"><iframe id="friendFrame" name="gameIframe" src="http://cdn.11h5.com/friend/friend.html?v=' + Date.now() + "&token=" + sdk.token + '" frameborder="no" border="0px" marginwidth="0px" marginheight="0px" scrolling="auto" style="width: 100%; height: 100%;"></iframe></div>')
    };
    sdk.hideFriend = function () {
        $("#friendFrameDiv").remove()
    };
    sdk.shareDesc = function (desc) {
        if (sdk.shareDatas) {
            if (sdk.isWeixin() || sdk.isQQ()) {
                for (var i = 0; i < sdk.shareDatas.length; i++) {
                    if (sdk.shareDatas[i]) {
                        if (sdk.shareDatas[i].desc) {
                            sdk.shareDatas[i].desc = desc
                        } else {
                            sdk.shareDatas[i].title = desc
                        }
                    }
                }
                if (sdk.isQQ()) {
                    mqq.onMenuShareTimeline(sdk.shareDatas[0]);
                    mqq.onMenuShareAppMessage(sdk.shareDatas[1]);
                    mqq.onMenuShareQQ(sdk.shareDatas[2]);
                    mqq.onMenuShareQzone(sdk.shareDatas[3])
                }
            } else if (sdk.isAvuAPP()) {
                sdk.shareDatas[1].text = desc;
                sdk.wxAppInit()
            }
        }
    };
    sdk.shareTitle = function (title) {
        if (sdk.shareDatas) {
            if (sdk.isWeixin() || sdk.isQQ()) {
                for (var i = 0; i < sdk.shareDatas.length; i++) {
                    if (sdk.shareDatas[i]) {
                        sdk.shareDatas[i].title = title
                    }
                }
                if (sdk.isQQ()) {
                    mqq.onMenuShareTimeline(sdk.shareDatas[0]);
                    mqq.onMenuShareAppMessage(sdk.shareDatas[1]);
                    mqq.onMenuShareQQ(sdk.shareDatas[2]);
                    mqq.onMenuShareQzone(sdk.shareDatas[3])
                }
            } else if (sdk.isAvuAPP()) {
                sdk.shareDatas[1].title = title;
                sdk.wxAppInit()
            }
        }
    };
    sdk.shareIcon = function (url) {
        if (!url) {
            if (sdk.getShareDomain) {
                url = sdk.getShareDomain.image
            }
        }
        if (sdk.shareDatas) {
            if (sdk.isWeixin() || sdk.isQQ()) {
                for (var i = 0; i < sdk.shareDatas.length; i++) {
                    if (sdk.shareDatas[i]) {
                        sdk.shareDatas[i].imgUrl = url
                    }
                }
                if (sdk.isQQ()) {
                    mqq.onMenuShareTimeline(sdk.shareDatas[0]);
                    mqq.onMenuShareAppMessage(sdk.shareDatas[1]);
                    mqq.onMenuShareQQ(sdk.shareDatas[2]);
                    mqq.onMenuShareQzone(sdk.shareDatas[3])
                }
            } else if (sdk.isAvuAPP()) {
                sdk.shareDatas[1].image = url;
                sdk.wxAppInit()
            }
        }
    };
    sdk.shareParams = function (params) {
        if (sdk.shareDatas) {
            var args = {};
            var paramKeys = Object.keys(params);
            for (var i in paramKeys) {
                var key = paramKeys[i];
                if (key.indexOf("cp_") == 0) {
                    args[key] = params[key]
                }
            }
            if (Object.keys(params).length) {
                if (sdk.isWeixin() || sdk.isQQ()) {
                    for (var i = 0; i < sdk.shareDatas.length; i++) {
                        sdk.shareDatas[i].link = sdk.buildURL(sdk.shareDatas[i].link, args)
                    }
                    if (sdk.isQQ()) {
                        mqq.onMenuShareTimeline(sdk.shareDatas[0]);
                        mqq.onMenuShareAppMessage(sdk.shareDatas[1]);
                        mqq.onMenuShareQQ(sdk.shareDatas[2]);
                        mqq.onMenuShareQzone(sdk.shareDatas[3])
                    }
                } else if (sdk.isAvuAPP()) {
                    sdk.shareDatas[1].url = sdk.buildURL(sdk.shareDatas[1].url, args);
                    sdk.shareDatas[1].wxsession = sdk.buildURL(sdk.shareDatas[1].wxsession, args);
                    sdk.shareDatas[1].wxtimeline = sdk.buildURL(sdk.shareDatas[1].wxtimeline, args);
                    sdk.shareDatas[1].qq = sdk.buildURL(sdk.shareDatas[1].qq, args);
                    sdk.shareDatas[1].qzone = sdk.buildURL(sdk.shareDatas[1].qzone, args);
                    sdk.wxAppInit()
                }
            }
        }
    };
    sdk.stat = function (item, sub_item, sub_sec_item) {};
    sdk.showTopImg = function (args) {
        if (args.renew) {
            $("div#showTopImg").remove()
        }
        if (!$("#showTopImg").length) {
            var html = '<div id="showTopImg" class="mask showTopImg">';
            html += "<div>";
            if (args.pos == "reverse") {
                html += '<img class="r5" src="' + args.src + '">';
                if (args.title) {
                    html += "<div>" + args.title + "</div>"
                }
            } else {
                if (args.title) {
                    html += "<div>" + args.title + "</div>"
                }
                html += '<img class="r5" src="' + args.src + '">'
            }
            html += "</div></div>";
            $("body").append(html);
            $("#showTopImg").click(function () {
                $("div#showTopImg").remove()
            })
        }
    };
    sdk.copy = function (string, txt, label, callback) {
        var __copy = function () {
            sdk.confirmDialog(txt ? txt : "复制成功", label ? label : null, label ? "好的" : "确认", function () {
                setTimeout(function () {
                    clipboard.destroy();
                    if (callback) {
                        callback()
                    }
                }, 10)
            }, function () {
                setTimeout(function () {
                    clipboard.destroy()
                }, 10)
            }, "复制提示");
            var clipboard = new Clipboard(".dialog-box a.unselect", {
                text: function () {
                    return string
                }
            });
            clipboard.on("success", function (e) {
                e.clearSelection()
            });
            clipboard.on("error", function (e) {
                var t = '<div class="flex gift-dialog"><label>SN：</label><div class="r3">' + string + '</div></div><p class="gift-dialog-info">长按可复制</p>';
                sdk.confirmDialog(t, null, null, null, null, "手动复制提示")
            })
        };
        var __loadClipboard = function () {
            if (window.Clipboard) {
                __copy()
            } else {
                sdk.loadSingleScript("https://cdn.11h5.com/static/js/sdk_copy.min.js", function () {
                    __copy()
                })
            }
        };
        __loadClipboard()
    };
    sdk.bindCash = function () {
        location.href = "http://play.11h5.com/cashbind/"
    };
    sdk.showLoading = function () {
        if (!$("#loadingBox").length) {
            var html = '<div id="loadingBox" class="mask loading"><div><div></div><div></div><div></div><div></div><div></div></div></div>';
            $("body").append(html)
        }
    };
    sdk.hideLoading = function () {
        $("#loadingBox").remove()
    };
    sdk.closePayBox = function () {
        $("#payBox").remove()
    };
    sdk.closePayRule = function () {
        $("#pay-rule").hide()
    };
    sdk.loadPayBox = function (args, wxpayCallback, alipayCallback, qqpayCallback) {
        if (!$("#payBox").length) {
            var t = '<div id="payBox" class="mask pay-box">';
            t += '<div class="r5">';
            t += '<div class="pay-head">确认支付方式<i class="icon-cancel" onclick="sdk.closePayBox()"></i></div>';
            t += '<div class="pay-info">';
            t += '<p id="pname"></p>';
            t += '<p id="price"></p>';
            t += "</div>";
            t += '<div class="pay-mode">';
            t += '<ol id="pay-list"></ol>';
            t += "</div>";
            t += '<a href="javascript:;" class="btn" id="readyPay">立即支付</a>';
            t += '<div class="flex pay-tip"><span class="flex-list" id="puid"></span><p class="active"><span>同意</span><a href="javascript:;">爱微游玩家条例</a></p></div>';
            t += "</div></div>";
            $("body").append(t)
        }
        $.get("https://api.11h5.com/conf?cmd=getProductInfo&pid=" + args["pid"] + "&" + Date.now(), function (data) {
            $("#pname").html(data["productName"] + "（" + data["des"] + "）");
            if (args["product_count"]) {
                data["cost"] = data["cost"] * args["product_count"]
            }
            if (Math.floor(data["cost"]) == data["cost"]) {
                $("#price").html("¥ " + data["cost"] + ".00")
            } else {
                $("#price").html("¥ " + data["cost"])
            }
        }, "json");
        if (wxpayCallback) {
            if (sdk.channelInfo) {
                if (!parseInt(sdk.channelInfo.hideWxPay)) {
                    $("#pay-list").append('<li data-type="wxpay" class="flex"><i class="icon-wxpay"></i><span class="flex-list">微信支付</span></li>')
                }
            } else {
                $("#pay-list").append('<li data-type="wxpay" class="flex"><i class="icon-wxpay"></i><span class="flex-list">微信支付</span></li>')
            }
        }
        if (alipayCallback) {
            $("#pay-list").append('<li data-type="alipay" class="flex"><i class="icon-alipay"></i><span class="flex-list">支付宝支付</span></li>')
        }
        if (qqpayCallback) {
            $("#pay-list").append('<li data-type="qqpay" class="flex"><i class="icon-qqpay"></i><span class="flex-list">QQ钱包支付</span></li>')
        }
        $("#puid").html("UID:" + sdk.uid);
        var _type = null,
            _isReady = true;
        $("#pay-list").off().on("click", "li", function () {
            _type = $(this).attr("data-type");
            $(this).addClass("active").siblings().removeClass("active")
        });
        $("#pay-list li").eq(0).trigger("click");
        $(".pay-tip>p").off().click(function (e) {
            if ($(e.target).html() != "爱微游玩家条例") {
                if ($(this).attr("class").indexOf("active") >= 0) {
                    $(this).removeClass("active");
                    _isReady = false
                } else {
                    $(this).addClass("active");
                    _isReady = true
                }
            }
        });
        $(".pay-tip>p a").off().click(function () {
            if (!$("#pay-rule").length) {
                var t = '<div id="pay-rule" class="mask pay-box pay-rule">';
                t += '<div class="r5">';
                t += '<div class="pay-head">爱微游玩家条例<i class="icon-cancel" onclick="sdk.closePayRule()"></i></div>';
                t += '<div id="pay-rule-box"></div>';
                t += "</div>";
                t += "</div>";
                $("body").append(t);
                $("#pay-rule-box").load("./contact.html .wrap", function () {})
            } else {
                $("#pay-rule").show()
            }
        });
        $("#readyPay").off().click(function () {
            if (!_isReady) {
                sdk.confirmDialog("支付前请先同意爱微游玩家条例！");
                return
            }
            if (_type == "wxpay") {
                wxpayCallback()
            } else if (_type == "alipay") {
                alipayCallback()
            } else if (_type == "qqpay") {
                qqpayCallback()
            }
            sdk.closePayBox();
            sdk.showLoading()
        })
    };
    sdk.pay = sdk.jumpPay = function (args, callback) {
        if (!sdk.isAllowPay()) {
            sdk.confirmDialog("支付系统暂不可用！")
        } else {
            args = args || {};
            if (args["pid"]) {
                if (sdk.isAvuAPP()) {
                    sdk.loadPayBox(args, function () {
                        sdk.wxAppPay(args, callback)
                    }, function () {
                        sdk.aliAppPay(args, callback)
                    }, null)
                } else if (sdk.isWeixin()) {
                    sdk.showLoading();
                    if (sdk.isPCWeixin()) {
                        sdk.wxqrcodePay(args, callback)
                    } else {
                        if (sdk.channelInfo && parseInt(sdk.channelInfo.alih5pay)) {
                            sdk.loadPayBox(args, function () {
                                sdk.wxPay(args, callback)
                            }, function () {
                                sdk.alih5Pay(args, callback)
                            }, null);
                            sdk.hideLoading()
                        } else {
                            sdk.wxPay(args, callback)
                        }
                    }
                } else if (sdk.isQQ()) {
                    sdk.qqPay(args, callback)
                } else {
                    if (sdk.channelInfo && parseInt(sdk.channelInfo.hideWxPay)) {
                        sdk.loadPayBox(args, null, function () {
                            sdk.aliPay(args, callback)
                        }, null)
                    } else {
                        sdk.loadPayBox(args, function () {
                            if (sdk.isMobile()) {
                                sdk.wxh5Pay(args, callback)
                            } else {
                                sdk.wxqrcodePay(args, callback)
                            }
                        }, function () {
                            sdk.aliPay(args, callback)
                        }, null)
                    }
                }
            } else {
                args.uid = sdk.uid;
                args.gameid = sdk.gameId;
                var url = "https://login.11h5.com/account/api.php?c=login&d=redirectPay&";
                for (var i in args) {
                    url += i + "=" + args[i] + "&"
                }
                location.href = url
            }
        }
    };
    sdk.wxPay = function (args, callback) {
        if (args) {
            if (sdk.channelInfo && parseInt(sdk.channelInfo.wxh5pay)) {
                sdk.wxh5Pay(args, null, function (data) {
                    window.location.href = sdk.buildURL("http://play.11h5.com/pay/wxpay.php", {
                        gameid: sdk.gameId,
                        trans_id: data.trans_id,
                        url: encodeURIComponent(data.mweb_url)
                    })
                })
            } else {
                var pid = args["pid"];
                var userdata = args["userdata"];
                var txid = args["txid"];
                var number = args["product_count"];
                var url = "https://login.11h5.com/pay/weixin/js_api_call.php?" + "gameid=" + sdk.gameId + "&uid=" + sdk.uid + "&product_id=" + pid;
                if (userdata) {
                    url += "&userdata=" + userdata
                }
                if (txid) {
                    url += "&txid=" + txid
                }
                if (number) {
                    url += "&product_count=" + number
                }
                $.get(url, function (data) {
                    var payData = data;
                    sdk.hideLoading();
                    if (payData["error"]) {
                        return alert("支付生成订单失败[" + payData["error"] + "]，请稍候再试!")
                    }
                    wx.chooseWXPay({
                        timestamp: payData["timestamp"],
                        nonceStr: payData["nonceStr"],
                        package: payData["package"],
                        signType: payData["signType"],
                        paySign: payData["paySign"],
                        success: function (res) {
                            if (callback) {
                                callback()
                            }
                        }, fail: function (err) {
                            sdk.wxh5Pay(args, null, function (data) {
                                window.location.href = sdk.buildURL("http://play.11h5.com/pay/wxpay.php", {
                                    gameid: sdk.gameId,
                                    trans_id: data.trans_id,
                                    url: encodeURIComponent(data.mweb_url)
                                })
                            })
                        }, cancel: function () {
                            sdk.confirmDialog("支付订单已取消")
                        }
                    })
                }, "json")
            }
        } else {
            sdk.hideLoading()
        }
    };
    sdk.checkTransStatus = function (trans_id, callback) {
        $.get("https://login.11h5.com/pay/paygate/is_trans_paid.php?trans_id=" + trans_id + "&" + Date.now(), function (data) {
            callback(data == "YES")
        })
    };
    sdk.wxAppPay = function (args, callback) {
        var url = sdk.buildURL(sdk.isAvuboxAPP() ? "https://login.11h5.com/pay/wxapp_awybox/js_api_call.php" : "https://login.11h5.com/pay/weixinapp/js_api_call.php", {
            gameid: sdk.gameId,
            uid: sdk.uid,
            product_id: args["pid"],
            userdata: args["userdata"],
            txid: args["txid"],
            app_pay: 1,
            _v: Date.now()
        });
        var number = args["product_count"];
        if (number) {
            url += "&product_count=" + number
        }
        window.__androidPayCallback = function (errCode) {
            sdk.hideConfirmDialog();
            var errCode = Number(errCode);
            if (errCode) {
                if (errCode == -2) {
                    sdk.confirmDialog("支付订单已取消")
                } else {
                    sdk.confirmDialog("支付失败" + errCode)
                }
            } else {
                if (callback) {
                    callback()
                }
            }
        };
        $.get(url, function (data) {
            var payData = {
                partnerId: sdk.isAvuboxAPP() ? "1480877232" : "1251302701",
                prepayId: data.prepayId,
                package: "Sign=WXPay",
                nonceStr: data.nonceStr,
                timeStamp: data.timestamp,
                sign: data.appsign
            };
            sdk.hideLoading();
            setTimeout(function () {
                sdk.confirmDialog("确认支付完成了吗？", "确定", "取消", function () {
                    sdk.checkTransStatus(data.trans_id, function (status) {
                        if (status) {
                            if (callback) {
                                callback()
                            }
                        } else {
                            sdk.confirmDialog("支付没有完成，如果确认已支付但游戏内未显示，请尝试刷新游戏，避免重复支付！")
                        }
                    })
                }, function () {})
            }, 500);
            if (sdk.isAndroid()) {
                return window.android.wxPay(JSON.stringify(payData), "__androidPayCallback")
            } else {
                sdk.initWebViewJavascriptBridge(function () {
                    window.WebViewJavascriptBridge.callHandler("wxPay", payData, function (errCode) {
                        sdk.hideConfirmDialog();
                        if (errCode) {
                            if (errCode == -2) {
                                sdk.confirmDialog("支付订单已取消")
                            } else {
                                sdk.confirmDialog("支付失败" + errCode)
                            }
                        } else {
                            if (callback) {
                                callback()
                            }
                        }
                    })
                })
            }
        }, "json")
    };
    sdk.qqPay = function (args, callback) {
        function __qqPay() {
            var url = sdk.buildURL("https://login.11h5.com/pay/qpay/payRequest.php", {
                gameid: sdk.gameId,
                uid: sdk.uid,
                product_id: args["pid"],
                userdata: args["userdata"],
                txid: args["txid"],
                _v: Date.now()
            });
            var number = args["product_count"];
            if (number) {
                url += "&product_count=" + number
            }
            $.get(url, function (data) {
                sdk.hideLoading();
                if (data.error) {
                    return alert("建立订单失败：" + data.error + ", 请选择其他支付方式。")
                }
                mqq.tenpay.pay({
                    tokenId: data.token_id,
                    pubAcc: "",
                    pubAccHint: ""
                }, function (result) {
                    if (typeof result == "string") {
                        sdk.confirmDialog("支付失败: " + result)
                    } else {
                        if (result.resultCode == 0) {
                            if (callback) {
                                callback()
                            }
                        } else {
                            sdk.confirmDialog("支付失败[" + result.resultCode + "]！")
                        }
                    }
                })
            }, "json")
        }
        if (window.mqq && window.mqq.tenpay && window.mqq.tenpay.pay) {
            __qqPay()
        } else {
            sdk.loadSingleScript("https://pub.idqqimg.com/qqmobile/qqapi.js?_bid=152", function () {
                __qqPay()
            })
        }
    };
    sdk.wxh5Pay = function (args, callback, transCallback) {
        var url = sdk.buildURL("https://login.11h5.com/pay/weixin/h5.php", {
            gameid: sdk.gameId,
            uid: sdk.uid,
            product_id: args["pid"],
            userdata: args["userdata"],
            txid: args["txid"],
            _v: Date.now()
        });
        var number = args["product_count"];
        if (number) {
            url += "&product_count=" + number
        }
        $.get(url, function (data) {
            sdk.hideLoading();
            var intervalId = setInterval(function () {
                sdk.checkTransStatus(data.trans_id, function (status) {
                    if (status) {
                        clearInterval(intervalId);
                        if (callback) {
                            callback()
                        }
                    }
                })
            }, 5e3);
            if (transCallback) {
                transCallback(data)
            } else {
                window.location.href = data.mweb_url
            }
        }, "json")
    };
    sdk.wxAppH5Pay = function (args, callback, transCallback) {
        var url = sdk.buildURL("https://login.11h5.com/pay/weixin/h5.php", {
            gameid: sdk.gameId,
            uid: sdk.uid,
            product_id: args["pid"],
            userdata: args["userdata"],
            txid: args["txid"],
            _v: Date.now()
        });
        var number = args["product_count"];
        if (number) {
            url += "&product_count=" + number
        }
        $.get(url, function (data) {
            sdk.hideLoading();
            var intervalId = setInterval(function () {
                sdk.checkTransStatus(data.trans_id, function (status) {
                    if (status) {
                        clearInterval(intervalId);
                        if (callback) {
                            callback()
                        }
                    }
                })
            }, 5e3);
            if (transCallback) {
                transCallback(data)
            } else {
                sdk.initWebViewJavascriptBridge(function () {
                    window.WebViewJavascriptBridge.callHandler("openURL", "http://play.11h5.com/game/shop.php?appH5Pay=1&url=" + encodeURIComponent(data.mweb_url), function (errCode) {
                        sdk.hideConfirmDialog()
                    })
                })
            }
        }, "json")
    };
    sdk.wxqrcodePay = function (args, callback) {
        var url = sdk.buildURL("https://login.11h5.com/pay/weixin/native_call_qrcode.php", {
            gameid: sdk.gameId,
            uid: sdk.uid,
            product_id: args["pid"],
            userdata: args["userdata"],
            txid: args["txid"],
            _v: Date.now()
        });
        var number = args["product_count"];
        if (number) {
            url += "&product_count=" + number
        }
        $.get(url, function (data) {
            sdk.hideLoading();
            var url = data.url;
            var trans_id = data.trans_id;
            if (url.indexOf("weixin://") < 0) {
                return alert("系统错误")
            }
            var intervalId = 0;
            var t = '<div class="mask pay-qrcode">';
            t += '<div class="r5">';
            t += '<div class="pay-head">微信扫码支付 <i class="icon-cancel"></i></div>';
            t += '<div id="qrcode"></div>';
            t += "<div>请使用<strong>[微信扫一扫]</strong>支付</div>";
            t += "</div>";
            t += "</div>";
            $("body").append(t);
            $(".pay-qrcode,pay-qrcode .icon-cancel").off().click(function () {
                __hideQRCodePay()
            });
            $("#qrcode").empty();

            function __hideQRCodePay() {
                $("div.pay-qrcode").remove();
                if (intervalId) {
                    clearInterval(intervalId)
                }
            }

            function __showQRCodePay() {
                var qrcode = new QRCode(document.getElementById("qrcode"), {
                    width: 196,
                    height: 196
                });
                qrcode.makeCode(url);
                intervalId = setInterval(function () {
                    sdk.checkTransStatus(trans_id, function (status) {
                        if (status) {
                            __hideQRCodePay();
                            if (callback) {
                                callback()
                            }
                        }
                    })
                }, 3e3)
            }
            if (window.QRCode) {
                __showQRCodePay()
            } else {
                sdk.loadSingleScript("https://cdn.11h5.com/static/js/qrcode.min.js", function () {
                    __showQRCodePay()
                })
            }
        }, "json")
    };
    sdk.alih5Pay = function (args, callback) {
        sdk.aliPay(args, callback, function (url) {
            window.location.href = sdk.buildURL("http://play.11h5.com/pay/alipay.php", {
                gameid: sdk.gameId,
                url: encodeURIComponent(url)
            })
        })
    };
    sdk.aliPay = function (args, callback, transCallback) {
        sdk.hideLoading();
        var url = sdk.buildURL("https://login.11h5.com/pay/alipay2/alipayapi.php", {
            gameid: sdk.gameId,
            uid: sdk.uid,
            product_id: args["pid"],
            userdata: args["userdata"],
            txid: args["txid"],
            backurl: location.href,
            _v: Date.now()
        });
        var number = args["product_count"];
        if (number) {
            url += "&product_count=" + number
        }
        if (transCallback) {
            transCallback(url)
        } else {
            window.location.href = url
        }
    };
    sdk.aliAppPay = function (args, callback) {
        var appVer = (navigator.userAgent.toLowerCase().match(/avu\/[\d.]+/gi) + "").replace(/[^0-9.]/gi, "");
        if (sdk.isiOS() && appVer > 1.3) {
            sdk.alih5Pay(args, callback)
        } else {
            sdk.aliPay(args, callback)
        }
    };
    sdk.checkNotify = function () {
        $.get("https://api.11h5.com/game?cmd=getNotice&gameid=" + sdk.gameId + "&" + Date.now(), function (data) {
            for (var i in data) {
                var noticeData = data[i];
                if (noticeData["type"] == 1) {
                    alert(noticeData["content"]);
                    if (noticeData["link"][0]) {
                        location.href = noticeData["link"][0]
                    }
                } else if (noticeData["type"] == 2) {
                    if (confirm(noticeData["content"])) {
                        if (noticeData["link"][0]) {
                            location.href = noticeData["link"][0]
                        }
                    } else {
                        if (noticeData["link"][1]) {
                            location.href = noticeData["link"][1]
                        }
                    }
                }
            }
        }, "json")
    };
    sdk.initWebViewJavascriptBridge = function (callback) {
        function setupWebViewJavascriptBridge(cb) {
            if (window.WebViewJavascriptBridge) {
                return cb(WebViewJavascriptBridge)
            }
            if (window.WVJBCallbacks) {
                return window.WVJBCallbacks.push(cb)
            }
            window.WVJBCallbacks = [cb];
            var WVJBIframe = document.createElement("iframe");
            WVJBIframe.style.display = "none";
            WVJBIframe.src = "wvjbscheme://__BRIDGE_LOADED__";
            document.documentElement.appendChild(WVJBIframe);
            setTimeout(function () {
                document.documentElement.removeChild(WVJBIframe)
            }, 0)
        }
        if (sdk.isAvuAPP()) {
            setupWebViewJavascriptBridge(function (bridge) {
                if (!sdk.isBridgeShareReady) {
                    sdk.isBridgeShareReady = true;
                    bridge.registerHandler("shareComplete", function (data, responseCallback) {
                        if (data == "wxtimeline") {
                            sdk.confirmShare()
                        }
                        if (sdk.shareCallback) {
                            sdk.shareCallback(data)
                        }
                    })
                }
                if (callback) {
                    callback(bridge)
                }
            })
        }
    };
    sdk.initAndroidAPPShare = function () {
        window.__shareComplete = function (data) {
            if (data == "onMenuShareTimeline") {
                sdk.confirmShare()
            }
            if (sdk.shareCallback) {
                sdk.shareCallback(data)
            }
        };
        if (!sdk.isBridgeShareReady) {
            sdk.isBridgeShareReady = true;
            window.android.shareComplete("__shareComplete")
        }
    };
    sdk.yybPay = function (args, callback) {
        if (args && args["pid"]) {
            $.get("https://login.11h5.com/pay/midas/check_token.php?gameid=" + sdk.gameId + "&openid=" + sdk.getURLVar("openid") + "&openkey=" + sdk.getURLVar("openkey") + "&" + Date.now(), function (data) {
                if (data["error"]) {
                    sdk.confirmDialog("获取登陆状态错误：" + data["error"])
                } else if (data["ok"]) {
                    var url = "https://login.11h5.com/pay/midas/trans.php?gameid=" + sdk.gameId + "&product_id=" + args["pid"] + "&uid=" + sdk.uid;
                    if (args["txid"]) {
                        url += "&txid=" + args["txid"]
                    }
                    if (args["userdata"]) {
                        url += "&userdata=" + args["userdata"]
                    }
                    $.get(url + "&" + Date.now(), function (data) {
                        if (data["error"]) {
                            sdk.confirmDialog("生成订单错误：" + data["error"])
                        } else {
                            var trans_id = data["trans_id"];
                            $.get("https://api.11h5.com/conf?cmd=getProductInfo&pid=" + args["pid"] + "&" + Date.now(), function (data) {
                                if (data["error"]) {
                                    sdk.confirmDialog("获取商品信息错误：" + data["error"])
                                } else {
                                    window["H5YSDK"].pay({
                                        saveValue: data["cost"] * data["moneyRate"],
                                        zoneId: args["zid"] ? args["zid"] : "1",
                                        offerid: sdk.getURLVar("offerid"),
                                        openid: sdk.getURLVar("openid"),
                                        openkey: sdk.getURLVar("openkey"),
                                        pf: sdk.getURLVar("pf"),
                                        pfkey: sdk.getURLVar("pfkey"),
                                        onError: function (ret) {
                                            console.log(ret)
                                        }, onSuccess: function (ret) {
                                            $.get("https://login.11h5.com/pay/midas/notify.php?trans_id=" + trans_id + "&appid=" + sdk.getURLVar("appid") + "&openid=" + sdk.getURLVar("openid") + "&openkey=" + sdk.getURLVar("openkey") + "&pf=" + sdk.getURLVar("pf") + "&pfkey=" + sdk.getURLVar("pfkey") + "&" + Date.now(), function (data) {
                                                if (callback) {
                                                    callback()
                                                }
                                                sdk.confirmDialog("购买成功，即将重新进入游戏...");
                                                window.top.location.reload()
                                            }, "json")
                                        }
                                    })
                                }
                            }, "json")
                        }
                    }, "json")
                } else {
                    sdk.confirmDialog("登陆状态失效，请重新进入游戏！");
                    sdk.yybLogout()
                }
            }, "json")
        }
    };
    sdk.yybPay2 = function (args, callback) {
        if (args && args["pid"]) {
            $.get("https://login.11h5.com/pay/midas/check_token.php?gameid=" + sdk.gameId + "&openid=" + sdk.getURLVar("openid") + "&openkey=" + sdk.getURLVar("openkey") + "&" + Date.now(), function (data) {
                if (data["error"]) {
                    sdk.confirmDialog("获取登陆状态错误：" + data["error"])
                } else if (data["ok"]) {
                    var url = sdk.buildURL("https://login.11h5.com/pay/midas/buy.php", {
                        gameid: sdk.gameId,
                        uid: sdk.uid,
                        product_id: args["pid"],
                        txid: args["txid"],
                        userdata: args["userdata"],
                        openid: sdk.getURLVar("openid"),
                        openkey: sdk.getURLVar("openkey"),
                        pf: sdk.getURLVar("pf"),
                        pfkey: sdk.getURLVar("pfkey")
                    });
                    $.get(url + "&" + Date.now(), function (data) {
                        if (data["error"]) {
                            sdk.confirmDialog("生成订单错误：" + data["error"])
                        } else {
                            var trans_id = data["trans_id"];
                            var url_params = data["url_params"];
                            $.get("https://api.11h5.com/conf?cmd=getProductInfo&pid=" + args["pid"] + "&" + Date.now(), function (data) {
                                if (data["error"]) {
                                    sdk.confirmDialog("获取商品信息错误：" + data["error"])
                                } else {
                                    var reqData = {
                                        saveValue: data["cost"] * data["moneyRate"],
                                        zoneId: args["zid"] ? args["zid"] : "1",
                                        offerId: sdk.getURLVar("offerid"),
                                        openId: sdk.getURLVar("openid"),
                                        openKey: sdk.getURLVar("openkey"),
                                        sessionId: "openid",
                                        sessionType: "openkey",
                                        goodsTokenUrl: url_params,
                                        pf: sdk.getURLVar("pf"),
                                        pfKey: sdk.getURLVar("pfkey"),
                                        isCanChange: false,
                                        unit: "",
                                        isShowSaveNum: true,
                                        callback: function (code) {
                                            if (code == window["H5YSDK"].PAY_STATE.SUCCESS) {
                                                if (callback) {
                                                    callback()
                                                }
                                                sdk.confirmDialog("购买成功！")
                                            } else if (code == 2 || code == window["H5YSDK"].PAY_STATE.USERCANCEL) {
                                                sdk.confirmDialog("取消了支付")
                                            } else {
                                                sdk.confirmDialog("支付失败: " + code)
                                            }
                                        }
                                    };
                                    window["H5YSDK"].requestPayForGood(reqData)
                                }
                            }, "json")
                        }
                    }, "json")
                } else {
                    sdk.confirmDialog("登陆状态失效，请重新进入游戏！");
                    sdk.yybLogout()
                }
            }, "json")
        }
    };
    sdk.yybLogout = function () {
        window.top.location.href = "https://qzs.qq.com/open/mobile/h5gamesdk/autologin.html?appid=" + sdk.getURLVar("appid")
    };
    sdk.yybAddShortCut = function (callback) {
        window["H5YSDK"].addGameDesktopShortCut(function (state) {
            if (state == H5YSDK.STATE.SUCCESS) {
                if (callback) {
                    callback()
                }
            }
        })
    };
    sdk.getShareQRInfo = function (callback, args) {
        if (sdk.shareQRInfo) {
            callback(sdk.shareQRInfo)
        } else {
            sdk.httpGet("https://web.11h5.com/share?cmd=getShareQRDomain&gameid=" + sdk.gameId + "&" + Date.now(), function (data) {
                sdk.shareQRInfo = data;
                sdk.shareQRInfo.shareURL = sdk.buildURL(sdk.shareQRInfo.shareURL.replace(/@/g, ""), {
                    fuid: sdk.uid,
                    rnd: sdk.randomString(args ? args.rnd : 16),
                    share_from: "qrcode"
                });
                callback(sdk.shareQRInfo)
            }, "json")
        }
    };
    sdk.shareDomain = function (callback) {
        if (sdk.getShareDomain) {
            callback(sdk.getShareDomain)
        }
    };
    sdk.execMessage = function (msg) {
        switch (msg.cmd) {
            case "showFocus":
            {
                sdk.showFocus(msg.args);
                break
            }
            case "logout":
            {
                sdk.logout();
                break
            }
            case "showFriend":
            {
                sdk.showFriend();
                break
            }
            case "hideFriend":
            {
                sdk.hideFriend();
                break
            }
            case "shareTitle":
            {
                if (sdk.readyCallback) {
                    sdk.readyMsgList.push(msg)
                } else {
                    sdk.shareTitle(msg.args)
                }
                break
            }
            case "shareIcon":
            {
                if (sdk.readyCallback) {
                    sdk.readyMsgList.push(msg)
                } else {
                    sdk.shareIcon(msg.args)
                }
                break
            }
            case "shareDesc":
            {
                if (sdk.readyCallback) {
                    sdk.readyMsgList.push(msg)
                } else {
                    sdk.shareDesc(msg.args)
                }
                break
            }
            case "shareParams":
            {
                if (sdk.readyCallback) {
                    sdk.readyMsgList.push(msg)
                } else {
                    sdk.shareParams(msg.args)
                }
                break
            }
            case "stat":
            {
                break
            }
            case "showTopImg":
            {
                sdk.showTopImg(msg.args);
                break
            }
            case "copy":
            {
                sdk.copy(msg.args);
                break
            }
            case "bindCash":
            {
                sdk.bindCash();
                break
            }
            case "downAvyApp":
            {
                sdk.downAvyApp();
                break
            }
            case "refresh":
            {
                window.location.reload();
                break
            }
            case "chatPrevent":
            {
                sdk.getPreventInfo = msg.args;
                break
            }
            case "saveGame":
            {
                sdk.saveGameDesktop();
                break
            }
        }
    };
    sdk.startRecord = function (callback) {
        wx.startRecord({
            success: function () {
                callback(true)
            }, cancel: function () {
                callback(false)
            }, fail: function () {
                callback(false)
            }
        })
    };
    sdk.stopRecord = function (callback) {
        wx.stopRecord({
            success: function (res) {
                callback(res.localId)
            }
        })
    };
    sdk.uploadVoice = function (localId, callback) {
        wx.uploadVoice({
            localId: localId,
            isShowProgressTips: 0,
            success: function (res) {
                callback(res.serverId)
            }
        })
    };
    sdk.downloadVoice = function (serverId, callback) {
        wx.downloadVoice({
            serverId: serverId,
            isShowProgressTips: 0,
            success: function (res) {
                callback(res.localId)
            }
        })
    };
    sdk.playVoice = function (localId, callback) {
        wx.onVoicePlayEnd({
            success: function (res) {
                callback(res.localId)
            }
        });
        wx.playVoice({
            localId: localId
        })
    };
    sdk.stopVoice = function (localId) {
        wx.stopVoice({
            localId: localId
        })
    };
    sdk.downAvyApp = function () {
        if (sdk.isTrial) {
            sdk.loadTrialLogin()
        } else {
            if (sdk.isAndroid()) {
                location.href = "https://a.app.qq.com/o/simple.jsp?pkgname=com.vutimes.app"
            } else if (sdk.isiOS()) {
                location.href = "https://itunes.apple.com/cn/app/%E7%88%B1%E5%BE%AE%E6%B8%B8/id1101086057?mt=8"
            } else {
                $("body").append('<iframe style="display:none;" src="https://cdn.11h5.com/static/app/android/aiweiyou_17.0.apk"></iframe>')
            }
        }
    };
    sdk.saveGameDesktop = function () {
        if (sdk.isiOS() && sdk.isMobile()) {
            $.get("https://api.11h5.com/login?cmd=getTokenKey&token=" + sdk.token, function (data) {
                if (data.tokenkey) {
                    location.href = sdk.buildURL(location.href, {
                        tokenkey: data.tokenkey
                    })
                } else {
                    sdk.confirmDialog(data.error)
                }
            }, "json")
        }
    };
    sdk.statOnline = function () {
        function __statFunc() {
            $.get("https://online.11h5.com/stat?cmd=online&gameid=" + sdk.gameId + "&token=" + sdk.token + "&" + Date.now(), function (data) {})
        }
        setInterval(function () {
            __statFunc()
        }, 3e4);
        __statFunc()
    };
    sdk.hideTrialBox = function () {
        $("#trialBox").remove()
    };
    sdk.loadTrialInfo = function () {
        var t = '<div id="trialBox" class="mask trial-box">';
        t += '<div class="r5">';
        t += '<div class="trial-head"><span>个人信息</span><i onclick="sdk.hideTrialBox()" class="icon-cancel"></i></div>';
        t += '<div class="trial-body">';
        t += '<div class="flex flex-x-center">';
        t += '<img id="trial-headimg" class="r50" src="" >';
        t += '<p class="flex flex-v">';
        t += '<span>昵称：<em id="trial-nickname"></em></span>';
        t += '<span>UID：<em id="trial-uid"></em></span>';
        t += "</p>";
        t += "</div>";
        t += '<a href="javascript:;" class="r3" id="trial-tab">切换账号</a>';
        t += "</div>";
        t += "</div>";
        t += "</div>";
        $("body").append(t);
        $.get("https://api.11h5.com/login?cmd=getUserByToken&token=" + sdk.token, function (data) {
            if (data.nickname) {
                try {
                    data.nickname = decodeURIComponent(data.nickname)
                } catch (e) {
                    data.nickname = "微游玩家"
                }
            } else {
                data.nickname = "微游玩家"
            } if (!data.headimgurl) {
                data.headimgurl = "https://cdn.11h5.com/static/image/vutimes.png"
            }
            $("#trial-headimg").attr("src", data.headimgurl);
            $("#trial-nickname").html(data.nickname);
            $("#trial-uid").html(data.uid)
        }, "json");
        $("#trial-tab").off().click(function () {
            $("#trialBox").remove();
            sdk.loadTrialLogin()
        })
    };
    sdk.loadTrialLogin = function () {
        var t = '<div id="trialBox" class="mask trial-box">';
        t += '<div class="r5">';
        t += '<div class="trial-head"><span>游戏登录</span><i onclick="sdk.hideTrialBox()" class="icon-cancel"></i></div>';
        t += '<div class="trial-body">';
        t += "<div>";
        t += '<div id="userBox" class="r3 flex"><i class="icod-mobile"></i><input class="flex-list" id="user" type="number" placeholder="请输入手机号码"></div>';
        t += '<div id="pwdBox" class="r3 flex"><i class="icod-lock"></i><input class="flex-list" id="pwd" type="password" placeholder="请填写密码"></div>';
        t += "</div>";
        t += '<a href="javascript:;" id="mBtn">登录/一键注册</a>';
        t += '<div class="flex flex-x-center">';
        t += '<a href="javascript:;" class="r3" onclick="sdk.qqLogin()"><i class="icod-qq"></i> QQ登录</a>';
        t += '<a href="javascript:;" class="r3" onclick="sdk.sinaLogin()"><i class="icod-sina"></i> 微博登录</a>';
        t += "</div>";
        t += "</div>";
        t += "</div>";
        t += "</div>";
        $("body").append(t);
        if (sdk.getItem("trial_user")) {
            $("#user").val(sdk.getItem("trial_user"));
            $("#pwd").val(sdk.getItem("trial_pwd"))
        } else {
            $("#user,#pwd").val("")
        }
        $("#mBtn").off().click(function () {
            var _user = $.trim($("#user").val()),
                _pwd = $.trim($("#pwd").val()),
                _imgCode = $.trim($("#imgCode").val()),
                _smsCode = $.trim($("#smsCode").val()),
                cls = $(this).attr("class");
            switch (cls) {
                case "":
                case undefined:
                    sdk.mobileParamsCheck({
                        phone: _user,
                        pwd: _pwd
                    }, function () {
                        if (sdk.ygLoginHasCode) {
                            if (!_imgCode) {
                                sdk.confirmDialog("请填写验证码");
                                return
                            }
                            sdk.ygLogin({
                                uid: _user,
                                password: _pwd,
                                verify_code: _imgCode,
                                verify_session: sdk.getItem("verify_session")
                            }, function () {
                                sdk.setItem("trial_user", _user);
                                sdk.setItem("trial_pwd", _pwd);
                                sdk.ygLoginHasCode = null
                            })
                        } else {
                            sdk.ygLogin({
                                uid: _user,
                                password: _pwd
                            }, function () {
                                sdk.setItem("trial_user", _user);
                                sdk.setItem("trial_pwd", _pwd)
                            })
                        }
                    });
                    break;
                case "getVerify":
                    sdk.mobileParamsCheck({
                        imgCode: _imgCode,
                        smsCode: _smsCode
                    }, function () {
                        sdk.mobileObjectBase({
                            d: "bindUidForPhone",
                            phone: _user,
                            smsCode: _smsCode,
                            passwd: _pwd,
                            token: sdk.token,
                            uid: sdk.uid,
                            trial: 1
                        }, function (data) {
                            sdk.hideLoading();
                            sdk.setItem("trial_user", _user);
                            sdk.setItem("trial_pwd", _pwd);
                            location.href = sdk.buildURL(location.href, {
                                token: sdk.token,
                                code: null
                            })
                        })
                    });
                    break
            }
        })
    };
    sdk.enableExitBanner = function () {
        var $history = $("<script />", {
            src: "//cdn.11h5.com/static/js/sdk_history.min.js?v=" + Date.now()
        });
        if ((new Date).getDate() != sdk.getItem("history_date") || !sdk.getItem("history_date")) {
            $("body").append($history)
        }
    };
    sdk.enableFloatBox = function () {
        var $float = $("<script />", {
            src: "//cdn.11h5.com/static/js/sdk_float.min.js?v=" + Date.now(),
            id: "ftBoxJs"
        });
        if (!$("#ftBoxJs").length) {
            $("body").append($float)
        }
    };
    sdk.ygLoginError = function (error) {
        switch (error) {
            case 101:
                sdk.confirmDialog("参数错误");
                break;
            case 102:
                sdk.confirmDialog("系统错误");
                break;
            case 201:
                sdk.confirmDialog("账户不存在");
                break;
            case 202:
                sdk.confirmDialog("账户已存在");
                break;
            case 203:
                sdk.confirmDialog("账户不合法");
                break;
            case 204:
                sdk.confirmDialog("账户被冻结");
                break;
            case 205:
                sdk.confirmDialog("账号或密码错误");
                break
        }
    };
    sdk.mobileCheckError = function (error) {
        sdk.hideLoading();
        switch (parseInt(error)) {
            case 1:
                sdk.confirmDialog("操作失败！");
                break;
            case 2:
            case 3:
                sdk.confirmDialog("验证码错误！");
                sdk.getVerifyImg("#refreshCode");
                $("#getCode").attr("class", "");
                break;
            case 4:
                sdk.confirmDialog("短信验证码参数错误！");
                break;
            case 5:
                sdk.confirmDialog("参数错误！");
                break;
            case 6:
                sdk.confirmDialog("网络出了点小状况！");
                break;
            case 7:
                sdk.confirmDialog("账户被冻结！");
                break;
            case 8:
                sdk.confirmDialog("参数失效！");
                break;
            case 9:
                sdk.confirmDialog("参数失效！");
                break;
            case 10:
                sdk.confirmDialog("手机号已经绑定或已注册！");
                break;
            case 11:
                sdk.confirmDialog("短信验证码错误！");
                break;
            case 12:
                sdk.confirmDialog("短信验证码超时！");
                break;
            case 13:
                sdk.confirmDialog("该手机号尚未绑定，请绑定后再执行操作，点击确认后重新登录", "确定", null, function () {
                    sdk.closeLoginBox();
                    sdk.smsCountDown(false, "#getCode");
                    sdk.auth()
                });
                break;
            case 1013:
                sdk.confirmDialog("短信请求过于频繁，请稍后再试");
                break
        }
    };
    sdk.ygLoginHasCode = null;
    sdk.ygLogin = function (params, callback) {
        $.post("https://login.11h5.com/account/api.php?c=login&d=auth", params, function (data) {
            if (data) {
                if (data.error) {
                    if (data.error == 103) {
                        if (data.flag == 1) {
                            sdk.confirmDialog("密码错误，尝试次数过多！")
                        }
                        if (data.flag == 5) {
                            if ($("#imgBox").css("display") == "none") {
                                sdk.confirmDialog("为了您的账户安全，请输入验证码")
                            } else {
                                sdk.confirmDialog("验证码错误")
                            }
                        }
                        sdk.ygLoginHasCode = true;
                        $("#imgBox").removeClass("login-hide");
                        if (sdk.getURLVar("trial")) {
                            var t = '<div id="imgBox" class="code flex"><i class="icod-subyzm"></i><input id="imgCode" type="text" placeholder="输入图片验证码"><img id="refreshCode" src="" alt=""></div>';
                            $("#trialBox .trial-body>div:nth-child(1)").append(t)
                        }
                        sdk.getVerifyImg("#refreshCode")
                    } else if (data.error == 201 && sdk.getURLVar("trial")) {
                        $("#userBox,#pwdBox").hide();
                        var t = '<div id="imgBox" class="code flex"><i class="icod-subyzm"></i><input id="imgCode" type="text" placeholder="输入图片验证码"><img id="refreshCode" src="" alt=""></div>';
                        t += '<div id="smsBox" class="code flex"><i class="icod-yzm"></i><input id="smsCode" type="number" pattern="[0-9]*" placeholder="请输入短信验证码"><a href="javascript:;" class="" id="getCode">获取验证码</a></div>';
                        $("#trialBox .trial-body>div:nth-child(1)").append(t);
                        $("#mBtn").attr("class", "getVerify");
                        sdk.getVerifyImg("#refreshCode");
                        $("#getCode").off().click(function () {
                            if ($(this).attr("class").indexOf("active") == -1) {
                                sdk.mobileParamsCheck({
                                    imgCode: $.trim($("#imgCode").val())
                                }, function () {
                                    sdk.getSmsCode({
                                        phone: $.trim($("#user").val()),
                                        imgCode: $.trim($("#imgCode").val()),
                                        type: 3
                                    }, function () {
                                        sdk.smsCountDown(true, "#getCode")
                                    })
                                })
                            }
                        })
                    } else {
                        sdk.ygLoginError(parseInt(data.error))
                    }
                } else {
                    if (callback) {
                        callback()
                    }
                    sdk.createCode(data["token"], function (code) {
                        if (code.code) {
                            location.href = sdk.buildURL(location.href, {
                                code: code.code
                            })
                        }
                    })
                }
            } else {
                sdk.confirmDialog("登录失败，请稍后重试！")
            }
        }, "json")
    };
    sdk.mobileObjectBase = function (args, callback) {
        $.post("https://login.11h5.com/account/api.php?c=phone&", args, function (data) {
            if (data.error == 0 || data.image) {
                callback(data)
            } else {
                sdk.mobileCheckError(data.error)
            }
        }, "json")
    };
    sdk.getVerifyImg = function (obj) {
        sdk.mobileObjectBase({
            d: "getVerifyImg",
            getBase64: 1
        }, function (data) {
            sdk.setItem("verify_session", data.verify_session);
            $(obj).attr("src", "data:image/png;base64," + data.image)
        });
        $(obj).off().click(function () {
            sdk.getVerifyImg(obj)
        })
    };
    sdk.getSmsCode = function (args, callback) {
        sdk.showLoading();
        sdk.mobileObjectBase({
            d: "verifyImgAndGetSms",
            phone: args.phone,
            verify_code: args.imgCode,
            type: args.type,
            verify_session: sdk.getItem("verify_session")
        }, function () {
            callback();
            sdk.hideLoading()
        })
    };
    sdk.smsCountDown = function (type, e) {
        var _time = 60;
        var auto = setInterval(function () {
            if (_time) {
                _time--;
                $(e).addClass("active").html(_time + "S 再次获取")
            } else {
                clearInterval(auto);
                $(e).attr("class", "").removeClass("active").html("重新获取")
            }
        }, 1e3);
        if (!type) {
            clearInterval(auto)
        }
    };
    sdk.mobileParamsCheck = function (args, callback) {
        if (!args.ygUser && args.ygUser !== undefined) {
            sdk.confirmDialog("请输入账号！");
            return
        } else {
            if (!args.phone && args.phone !== undefined) {
                sdk.confirmDialog("请输入手机号！");
                return
            }
            if (!/^1[3|4|5|7|8]\d{9}$/.test(args.phone) && args.phone !== undefined) {
                sdk.confirmDialog("请填入有效的手机号码！");
                return
            }
        } if (!args.pwd && args.pwd !== undefined) {
            sdk.confirmDialog("请输入密码！");
            return
        }
        if (!args.imgCode && args.imgCode !== undefined) {
            sdk.confirmDialog("请输入图片验证码！");
            return
        }
        if (!args.smsCode && args.smsCode !== undefined) {
            sdk.confirmDialog("请输入短信验证码！");
            return
        }
        callback()
    };
    sdk.loadLoginBox = function (wxLgCallback, qrcodeLgCallback, qqLgCallback, sinaLgCallback, ygLgCallback, mbLgCallback) {
        if (!$("#loginBox").length) {
            var html = '<div id="loginBox" class="mask login-box">';
            html += '<div class="r5">';
            html += '<div class="login-head"><img src="//cdn.11h5.com/static/image/vutimes_logo.png" alt="爱微游"><span>游戏登录</span></div>';
            html += '<div class="login-body login-hide">';
            html += "<div>";
            html += '<div id="userBox" class="flex"><i class="icod-user"></i><input class="flex-list" id="user" type="text" value="" placeholder="请输入游光账号"></div>';
            html += '<div id="pwdBox" class="flex"><i class="icod-lock"></i><input class="flex-list" id="pwd" type="password" value="" placeholder="请填写密码"></div>';
            html += '<div id="imgBox" class="code flex login-hide"><i class="icod-yzm"></i><input id="imgCode" type="text" placeholder="输入图片验证码"><img id="refreshCode" src="" alt=""><em class="icod-load"></em></div>';
            html += '<div id="smsBox" class="code flex login-hide"><i class="icod-subyzm"></i><input id="smsCode" type="number" placeholder="请输入短信验证码"><a href="javascript:;" id="getCode">获取验证码</a></div>';
            html += "</div>";
            html += '<a href="javascript:;" class="btn" id="mBtn">登录</a>';
            html += '<p id="suBtn" class="login-hide">通过短信验证码登录</p>';
            html += '<div id="loginOption" class="flex flex-x-between login-hide"><a href="javascript:;" id="forgetPwd">忘了密码?</a><a href="javascript:;" id="otherLogin">其他方式登录</a></div>';
            html += "<fieldset><legend>其他登录方式</legend></fieldset>";
            html += "</div>";
            html += '<div class="login-mode">';
            html += '<ol class="flex">';
            html += '<li class="flex-list ' + (wxLgCallback ? "list-show" : "") + '" id="wxLogin" title="微信登录"><div class="r50"><i class="icod-wechat"></i></div></li>';
            html += '<li class="flex-list ' + (qrcodeLgCallback ? "list-show" : "") + '" id="wxQcLogin" title="微信扫码登录"><div class="r50"><i class="icod-wechat"></i></div></li>';
            html += '<li class="flex-list qq ' + (qqLgCallback ? "list-show" : "") + '" id="qqLogin" title="QQ登录"><div class="r50"><i class="icod-qq"></i></div></li>';
            html += '<li class="flex-list sina ' + (sinaLgCallback ? "list-show" : "") + '" id="sinaLogin" title="新浪微博登录"><div class="r50"><i class="icod-sina"></i></div></li>';
            html += '<li class="flex-list mobile ' + (mbLgCallback ? "list-show" : "") + '" id="mobileLogin" title="手机登录"><div class="r50"><i class="icod-mobile"></i></div></li>';
            html += "</ol>";
            if (ygLgCallback) {
                html += '<a id="tagYgLogin" href="javascript:;">游光账号登录</a>'
            }
            html += "</div>";
            html += "</div>";
            html += "</div>";
            $("body").append(html)
        }
        $(".login-body>div>div").on("click", "input", function () {
            var id = $(this).attr("id").replace(/#/g, "");
            var input = document.getElementById(id);
            if (input) {
                input.setSelectionRange(0, input.value.length)
            }
            $(this).parent().addClass("active").siblings().removeClass("active")
        });
        $("#loginBox .login-mode ol").off().on("click", "li", function () {
            var _index = $(this).index();
            if (_index == 0) {
                wxLgCallback()
            } else if (_index == 1) {
                qrcodeLgCallback()
            } else if (_index == 2) {
                qqLgCallback()
            } else if (_index == 3) {
                sinaLgCallback()
            } else if (_index == 4) {
                $("#loginBox .icod-user").addClass("icod-mobile");
                if (!(navigator.platform.indexOf("Mac") >= 0 || navigator.platform.indexOf("Win") >= 0)) {
                    $("#user").attr("type", "number")
                }
                $("#user").attr("placeholder", "请输入手机号码");
                $("#mBtn").attr("data-type", "phoneLogin");
                $("#suBtn").attr("data-type", "smsLogin");
                $("#user,#pwd").val("");
                $("#loginBox fieldset,#loginBox .login-mode").addClass("login-hide");
                $("#loginOption,#loginBox .login-body,#suBtn").removeClass("login-hide");
                if (sdk.getItem("avy_user_phone")) {
                    $("#userBox input").val(sdk.getItem("avy_user_phone"))
                }
                if (sdk.getItem("avy_pwd_phone")) {
                    $("#pwdBox input").val(sdk.getItem("avy_pwd_phone"))
                }
            }
        });
        $("#tagYgLogin").off().click(function () {
            $("#tagYgLogin,#loginOption,#suBtn").addClass("login-hide");
            $("#loginBox .login-body,#loginBox fieldset").removeClass("login-hide");
            $("#mBtn").attr("data-type", "ygLogin");
            $("#loginBox .icod-user").removeClass("icod-mobile");
            $("#user").attr("placeholder", "请输入游光账号").attr("type", "text");
            $("#loginBox .login-mode ol").addClass("active");
            $("#user,#pwd").val("");
            if (sdk.getItem("avy_user")) {
                $("#userBox input").val(sdk.getItem("avy_user"))
            }
            if (sdk.getItem("avy_pwd")) {
                $("#pwdBox input").val(sdk.getItem("avy_pwd"))
            }
        });
        $("#otherLogin").off().click(function () {
            $("#loginBox .login-mode,#tagYgLogin").removeClass("login-hide");
            $("#loginBox .login-mode ol").removeClass("active");
            $("#loginBox .login-body").addClass("login-hide")
        });
        $("#forgetPwd").off().click(function () {
            $("#pwdBox,#loginOption").addClass("login-hide");
            $("#imgBox,#smsBox").removeClass("login-hide");
            $("#mBtn").attr("data-type", "modifyNext").text("下一步");
            $("#suBtn").attr("data-type", "back").text("返回登录");
            $("#getCode").attr("data-type", 1);
            sdk.getVerifyImg("#refreshCode")
        });
        $("#getCode").off().click(function () {
            if ($(this).attr("class") != "active") {
                var _type = $(this).attr("data-type");
                sdk.mobileParamsCheck({
                    phone: $.trim($("#user").val()),
                    imgCode: $.trim($("#imgCode").val())
                }, function () {
                    $(this).attr("class", "active");
                    sdk.smsCountDown(true, "#getCode");
                    sdk.getSmsCode({
                        phone: $.trim($("#user").val()),
                        imgCode: $.trim($("#imgCode").val()),
                        type: _type
                    }, function () {})
                })
            }
        });
        $("#mBtn").off().click(function () {
            var _user = $.trim($("#user").val()),
                _pwd = $.trim($("#pwd").val()),
                _imgCode = $.trim($("#imgCode").val()),
                _smsCode = $.trim($("#smsCode").val()),
                _type = $(this).attr("data-type");
            switch (_type) {
                case "ygLogin":
                    sdk.mobileParamsCheck({
                        user: _user,
                        pwd: _pwd
                    }, function () {
                        if (sdk.ygLoginHasCode) {
                            if (!_imgCode) {
                                sdk.confirmDialog("请填写验证码");
                                return
                            }
                            ygLgCallback({
                                uid: _user,
                                password: _pwd,
                                verify_code: _imgCode,
                                verify_session: sdk.getItem("verify_session")
                            }, function () {
                                sdk.setItem("avy_user", _user);
                                sdk.setItem("avy_pwd", _pwd);
                                sdk.ygLoginHasCode = null
                            })
                        } else {
                            ygLgCallback({
                                uid: _user,
                                password: _pwd
                            }, function () {
                                sdk.setItem("avy_user", _user);
                                sdk.setItem("avy_pwd", _pwd)
                            })
                        }
                    });
                    break;
                case "phoneLogin":
                    sdk.mobileParamsCheck({
                        phone: _user,
                        pwd: _pwd
                    }, function () {
                        if (sdk.ygLoginHasCode) {
                            if (!_imgCode) {
                                sdk.confirmDialog("请填写验证码");
                                return
                            }
                            mbLgCallback({
                                uid: _user,
                                password: _pwd,
                                verify_code: _imgCode,
                                verify_session: sdk.getItem("verify_session")
                            }, function () {
                                sdk.setItem("avy_user_phone", _user);
                                sdk.setItem("avy_pwd_phone", _pwd);
                                sdk.ygLoginHasCode = null
                            })
                        } else {
                            mbLgCallback({
                                uid: _user,
                                password: _pwd
                            }, function () {
                                sdk.setItem("avy_user_phone", _user);
                                sdk.setItem("avy_pwd_phone", _pwd)
                            })
                        }
                    });
                    break;
                case "smsLogin":
                    sdk.mobileParamsCheck({
                        smsCode: _smsCode
                    }, function () {
                        sdk.mobileObjectBase({
                            d: "phoneSmsLogin",
                            phone: _user,
                            smsCode: _smsCode
                        }, function (data) {
                            sdk.createCode(data["token"], function (code) {
                                if (code.code) {
                                    location.href = sdk.buildURL(location.href, {
                                        code: code.code
                                    })
                                }
                            })
                        })
                    });
                    break;
                case "modifyNext":
                    sdk.mobileParamsCheck({
                        phone: _user,
                        imgCode: _imgCode,
                        smsCode: _smsCode
                    }, function () {
                        $("#userBox,#imgBox,#smsBox").addClass("login-hide");
                        $("#pwdBox").removeClass("login-hide").find("input").val("").attr("placeHolder", "密码长度不能少于6位");
                        $("#mBtn").attr("data-type", "modify").text("完成修改")
                    });
                    break;
                case "modify":
                    if (_pwd.length < 6) {
                        sdk.confirmDialog("密码过于简单，请设置长度不少于6位的密码", null, "好的");
                        return
                    }
                    sdk.mobileParamsCheck({
                        pwd: _pwd
                    }, function () {
                        sdk.mobileObjectBase({
                            d: "chgPasswd",
                            phone: _user,
                            passwd: _pwd,
                            smsCode: _smsCode
                        }, function () {
                            sdk.confirmDialog("密码修改成功，请重新登录", null, "好的", null, function () {
                                sdk.removeItem("avy_pwd_phone");
                                $("#suBtn").trigger("click");
                                $("#userBox").removeClass("login-hide");
                                $("#pwdBox input").attr("placeHolder", "请输入密码").val("")
                            })
                        })
                    });
                    break
            }
        });
        $("#suBtn").off().click(function () {
            var _type = $(this).attr("data-type");
            switch (_type) {
                case "back":
                    $("#mBtn").attr("data-type", "phoneLogin").text("登录");
                    $("#suBtn").attr("data-type", "smsLogin").text("通过短信验证码登录");
                    $("#imgBox,#smsBox").addClass("login-hide");
                    $("#loginOption,#pwdBox,#userBox").removeClass("login-hide");
                    $("#pwdBox input").attr("placeHolder", "请输入密码");
                    break;
                case "smsLogin":
                    $("#pwdBox,#loginOption").addClass("login-hide");
                    $("#imgBox,#smsBox").removeClass("login-hide");
                    $("#mBtn").attr("data-type", "smsLogin");
                    $("#suBtn").attr("data-type", "back").text("返回登录");
                    $("#getCode").attr("data-type", 2);
                    sdk.getVerifyImg("#refreshCode");
                    break
            }
        })
    };
    sdk.closeLoginBox = function () {
        $("#loginBox").remove()
    };
    sdk.confirmDialog = function (txt, oklabel, cancellabel, okcallback, cancelcallback, title, callback) {
        var html = '<div id="confirmDialog" class="mask dialog-box">';
        html += '<div class="r5">';
        html += "<div>" + (title ? title : "提示信息") + "</div>";
        html += "<div>" + txt + "</div>";
        html += '<div class="flex">';
        html += '<a href="javascript:;" data-type="cancel" class="flex-list unselect">' + (cancellabel ? cancellabel : "关闭") + "</a>";
        if (oklabel) {
            html += '<a href="javascript:;" data-type="ok" class="flex-list unselect ok">' + oklabel + "</a>"
        }
        html += "</div></div></div>";
        $("body").append(html);
        if (callback) {
            callback()
        }
        $("#confirmDialog .flex a").click(function () {
            var type = $(this).attr("data-type");
            if (type == "cancel") {
                if (cancelcallback) {
                    cancelcallback()
                }
            } else if (type == "ok") {
                if (okcallback) {
                    okcallback()
                }
            }
            $(this).parents("#confirmDialog").remove()
        })
    };
    sdk.hideConfirmDialog = function () {
        $("#confirmDialog").remove()
    };
    sdk.loadHeadImg = function (url, size) {
        if (url.substr(-2) == "/0") {
            url = url.replace(/\/0/g, "/" + size + "")
        }
        if (location.protocol == "https:") {
            url = url.replace("http:", "https:")
        }
        return url
    };
    sdk.combineStat = function (uid, item, args) {
        if (!uid) {
            uid = sdk.getItem("uuid");
            if (!uid) {
                uid = sdk.createUUID();
                sdk.setItem("uuid", uid)
            }
        }
        $.get("https://comstat.11h5.com/stat?cmd=combineStat&uid=" + uid + "&item=" + item + "&subItem=" + JSON.stringify(args), function () {}, "json")
    };
    sdk.createUUID = function () {
        var d = (new Date).getTime();
        var uuid = "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function (c) {
            var r = (d + Math.random() * 16) % 16 | 0;
            d = Math.floor(d / 16);
            return (c == "x" ? r : r & 3 | 8).toString(16)
        });
        return uuid
    };
    window.AWY_SDK = sdk;
    $("#share_logo").remove();
    $("body").prepend('<div id="share_logo" style="margin:0 auto;display:none;"><img src="//cdn.11h5.com/static/image/share_logo.jpg" /></div>')
})();
var sdk = window.AWY_SDK;